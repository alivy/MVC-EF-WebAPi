2013-10-11 11:59:04,693 [8752] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 11:59:04,726 [8752] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 11:59:04,733 [8752] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 11:59:04,734 [8752] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 11:59:15,009 [10348] DEBUG Servicesys_user - 获取实体对象
2013-10-11 11:59:15,027 [10348] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'lhs'and Password =  'lhs'and IsEnable =  'True'
2013-10-11 11:59:15,140 [10348] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'lhs' 
2013-10-11 11:59:15,226 [10348] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('lhs','刘会胜','LHS-PC','ILData[0]/localhost','福建省厦门市','2013-10-11 11:59:15')
2013-10-11 11:59:15,229 [10348] DEBUG Servicemms_project - 获取实体对象
2013-10-11 11:59:15,230 [10348] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2013-10-11 11:59:15,426 [6008] DEBUG Sys - select * from sys_userSetting where UserCode='lhs'
2013-10-11 11:59:21,425 [7400] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'lhs' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'lhs'
  )  
)
order by B.MenuSeq,B.MenuCode
2013-10-11 11:59:23,637 [7400] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2013-10-11 11:59:23,659 [7400] DEBUG Servicemms_warehouse - 获取动态列表
2013-10-11 11:59:23,661 [7400] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2013-10-11 11:59:23,703 [7400] DEBUG Servicesys_code - 获取动态列表
2013-10-11 11:59:23,704 [7400] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2013-10-11 11:59:29,530 [10348] DEBUG Servicemms_receive - 获取动态列表
2013-10-11 11:59:29,531 [10348] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2013-10-11 11:59:29,642 [10348] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2013-10-11 11:59:35,746 [6008] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Psi/purchase/Index','/Psi/purchase')
2013-10-11 11:59:39,027 [7400] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 11:59:39,083 [7400] ERROR Servicepsi_purchase - 获取动态列表失败
System.NullReferenceException: 未将对象引用设置到对象的实例。
   在 Zephyr.Core.Db.Context(String ConnName) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Core\Db.cs:行号 48
   在 Zephyr.Core.ServiceBase`1.get_db() 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBase.cs:行号 135
   在 Zephyr.Core.ServiceBase`1.BuilderParse(ParamQuery param) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseUtils.cs:行号 53
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass63.<GetDynamicList>b__62() 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 28
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
2013-10-11 11:59:45,649 [7400] ERROR /api/psi/purchase - System.NullReferenceException: 未将对象引用设置到对象的实例。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetDynamicList(ParamQuery param) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 28
   在 Zephyr.Core.ServiceBase`1.GetDynamicListWithPaging(ParamQuery param) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 43
   在 Zephyr.Areas.Psi.Controllers.PurchaseApiController.Get(RequestWrapper query) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Web\Areas\Psi\Controllers\PurchaseController.cs:行号 146
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
2013-10-11 11:59:48,153 [7576] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Psi/purchase/Index','/Psi/purchase')
2013-10-11 11:59:49,996 [6008] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 11:59:50,045 [6008] ERROR Servicepsi_purchase - 获取动态列表失败
System.NullReferenceException: 未将对象引用设置到对象的实例。
   在 Zephyr.Core.Db.Context(String ConnName) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Core\Db.cs:行号 48
   在 Zephyr.Core.ServiceBase`1.get_db() 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBase.cs:行号 135
   在 Zephyr.Core.ServiceBase`1.BuilderParse(ParamQuery param) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseUtils.cs:行号 53
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass63.<GetDynamicList>b__62() 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 28
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
2013-10-11 11:59:55,895 [6008] ERROR /api/psi/purchase - System.NullReferenceException: 未将对象引用设置到对象的实例。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetDynamicList(ParamQuery param) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 28
   在 Zephyr.Core.ServiceBase`1.GetDynamicListWithPaging(ParamQuery param) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 43
   在 Zephyr.Areas.Psi.Controllers.PurchaseApiController.Get(RequestWrapper query) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Web\Areas\Psi\Controllers\PurchaseController.cs:行号 146
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
2013-10-11 12:00:42,275 [10136] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/log/Index','/Sys/log')
2013-10-11 12:00:45,717 [10136] DEBUG Servicesys_loginHistory - 获取实体列表
2013-10-11 12:00:45,726 [10136] DEBUG Sys - select top 20 
        A.*
     from 
        sys_loginHistory A
     order by A.ID desc
2013-10-11 12:00:45,781 [1164] DEBUG Servicesys_log - 获取实体列表
2013-10-11 12:00:45,782 [10136] DEBUG Sys - select count(*) from ( select 
        A.*
     from 
        sys_loginHistory A
     ) tb_temp
2013-10-11 12:00:45,796 [1164] DEBUG Sys - select top 20 
        A.*
     from 
        sys_log A
     order by A.ID desc
2013-10-11 12:00:45,917 [1164] DEBUG Sys - select count(*) from ( select 
        A.*
     from 
        sys_log A
     ) tb_temp
2013-10-11 12:02:27,823 [2040] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 12:02:27,963 [2040] ERROR Servicepsi_purchase - 获取动态列表失败
System.NullReferenceException: 未将对象引用设置到对象的实例。
   在 Zephyr.Core.Db.Context(String ConnName) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Core\Db.cs:行号 48
   在 Zephyr.Core.ServiceBase`1.get_db() 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBase.cs:行号 135
   在 Zephyr.Core.ServiceBase`1.BuilderParse(ParamQuery param) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseUtils.cs:行号 53
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass63.<GetDynamicList>b__62() 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 28
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
2013-10-11 12:03:05,356 [2040] ERROR /api/psi/purchase - System.NullReferenceException: 未将对象引用设置到对象的实例。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetDynamicList(ParamQuery param) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 28
   在 Zephyr.Core.ServiceBase`1.GetDynamicListWithPaging(ParamQuery param) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 43
   在 Zephyr.Areas.Psi.Controllers.PurchaseApiController.Get(RequestWrapper query) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Web\Areas\Psi\Controllers\PurchaseController.cs:行号 146
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
2013-10-11 12:03:09,878 [8752] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 12:03:09,911 [8752] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 12:03:09,918 [8752] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 12:03:09,919 [8752] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 12:03:10,096 [8752] DEBUG Psi - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 12:03:10,481 [8752] DEBUG Psi - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 12:03:12,287 [5924] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 12:03:12,321 [5924] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 12:03:12,329 [5924] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 12:03:12,329 [5924] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 12:03:12,336 [5924] DEBUG Psi - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 12:03:12,336 [5924] DEBUG Psi - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 12:03:18,998 [7816] DEBUG Servicesys_user - 获取实体对象
2013-10-11 12:03:19,016 [7816] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'lhs'and Password =  'lhs'and IsEnable =  'True'
2013-10-11 12:03:19,093 [7816] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'lhs' 
2013-10-11 12:03:19,250 [7816] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('lhs','','LHS-PC','27.154.21.0/localhost','福建省厦门市','2013-10-11 12:03:19')
2013-10-11 12:03:19,256 [7816] DEBUG Servicemms_project - 获取实体对象
2013-10-11 12:03:19,256 [7816] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2013-10-11 12:03:19,456 [9664] DEBUG Sys - select * from sys_userSetting where UserCode='lhs'
2013-10-11 12:03:31,158 [9420] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'lhs' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'lhs'
  )  
)
order by B.MenuSeq,B.MenuCode
2013-10-11 12:03:35,107 [9664] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Psi/purchase/Index','/Psi/purchase')
2013-10-11 12:03:42,990 [10024] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 12:03:42,992 [10024] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 12:03:43,328 [10024] ERROR Servicepsi_purchase - 获取动态列表失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'Supplier' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QueryMany[TEntity,TList](Action`2 customMapper) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 14
   在 Zephyr.Data.DbCommand.QueryMany[TEntity](Action`2 customMapper) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 36
   在 Zephyr.Data.SelectBuilder`1.QueryManyDynamic() 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 150
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass63.<GetDynamicList>b__62() 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 28
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:cbdcef99-9e4a-40b7-ad91-934419947fc3
2013-10-11 12:03:47,373 [10024] ERROR /api/psi/purchase - System.Data.SqlClient.SqlException (0x80131904): 列名 'Supplier' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetDynamicList(ParamQuery param) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 28
   在 Zephyr.Core.ServiceBase`1.GetDynamicListWithPaging(ParamQuery param) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 43
   在 Zephyr.Areas.Psi.Controllers.PurchaseApiController.Get(RequestWrapper query) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Web\Areas\Psi\Controllers\PurchaseController.cs:行号 146
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:cbdcef99-9e4a-40b7-ad91-934419947fc3
2013-10-11 12:12:51,935 [11280] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 12:17:15,518 [11280] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 12:17:17,336 [11280] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 12:17:22,110 [5272] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 12:17:22,110 [5272] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 12:17:22,111 [5272] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 12:17:24,170 [6032] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 12:17:24,170 [6032] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 12:17:24,171 [6032] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 12:17:24,948 [8856] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 12:17:24,948 [8856] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 12:17:24,949 [8856] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 12:17:32,516 [5272] DEBUG Servicepsi_purchase - 获取新主键
2013-10-11 12:17:32,518 [5272] DEBUG Psi - select isnull(max(BillNo),0) from psi_purchase
2013-10-11 12:17:32,618 [12248] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 12:17:37,274 [8404] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2013-10-11 12:17:39,111 [6032] DEBUG Servicesys_menu - 获取动态列表
2013-10-11 12:17:39,111 [6032] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2013-10-11 12:19:25,642 [6008] DEBUG Servicesys_menu - 编辑记录
2013-10-11 12:19:25,665 [6008] DEBUG Servicesys_menu - 获取动态对象
2013-10-11 12:19:25,670 [6008] DEBUG Sys - select 
        sys_menu
    .* from 
        sys_menu
     where  MenuCode =  '310ea02c-2468-4fb0-8f77-20f855d67d7b'
2013-10-11 12:19:25,687 [6008] DEBUG Sys - insert into 
        sys_menu
    ([MenuName],[MenuCode],[ParentCode],[IconClass],[URL],[IsVisible],[IsEnable],[MenuSeq],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('采购明细','1019','01','','/psi/purchase/edit','false','true','','刘会胜','2013-10-11 12:19:25','刘会胜','2013-10-11 12:19:25')
2013-10-11 12:19:26,000 [6008] DEBUG Sys - insert into sys_log([UserCode],[UserName],[Position],[Target],[Type],[Message],[Date]) values('lhs','刘会胜','api/mms/send','菜单数据','修改','{"list":{"deleted":[],"inserted":[{"_id":"310ea02c-2468-4fb0-8f77-20f855d67d7b","MenuName":"采购明细","MenuCode":"1019","ParentCode":"01","IconClass":"","URL":"/psi/purchase/edit","IsVisible":"false","IsEnable":"true","MenuSeq":""}],"updated":[],"_changed":true}}','2013-10-11 12:19:25')
2013-10-11 12:19:26,834 [11420] DEBUG Servicesys_menu - 获取动态列表
2013-10-11 12:19:26,835 [11420] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2013-10-11 12:19:32,805 [3564] DEBUG Servicepsi_purchase - 获取新主键
2013-10-11 12:19:32,806 [3564] DEBUG Psi - select isnull(max(BillNo),0) from psi_purchase
2013-10-11 12:19:32,858 [10724] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 12:19:40,422 [12284] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/role/Index','/Sys/role')
2013-10-11 12:19:40,426 [12284] DEBUG Servicesys_user - 获取动态列表
2013-10-11 12:19:40,426 [12284] DEBUG Sys - select UserCode,UserName from sys_user
2013-10-11 12:19:40,428 [12284] DEBUG Servicesys_organize - 获取动态列表
2013-10-11 12:19:40,428 [12284] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2013-10-11 12:19:41,697 [7324] DEBUG Servicesys_role - 获取实体列表
2013-10-11 12:19:41,703 [7324] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2013-10-11 12:19:43,706 [12284] DEBUG Servicesys_permission - 获取动态列表
2013-10-11 12:19:43,707 [12284] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='super' and B.PermissionCode = A.PermissionCode 
2013-10-11 12:19:43,721 [9120] DEBUG Sys - select * from sys_button order by ButtonSeq
2013-10-11 12:19:43,726 [9120] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='super' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='super'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='super'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='super'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='super'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='super'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='super'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='super'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='super'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='super'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='super'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='super'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='super'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='super'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='super'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2013-10-11 12:19:43,786 [9120] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'super'
2013-10-11 12:19:56,869 [10724] DEBUG Servicesys_role - 修改角色菜单权限
2013-10-11 12:19:56,874 [10724] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'super'
2013-10-11 12:19:56,875 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1019')
2013-10-11 12:19:56,876 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10')
2013-10-11 12:19:56,876 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1002')
2013-10-11 12:19:56,877 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1001')
2013-10-11 12:19:56,877 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1009')
2013-10-11 12:19:56,878 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1010')
2013-10-11 12:19:56,878 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1013')
2013-10-11 12:19:56,879 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1007')
2013-10-11 12:19:56,880 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1006')
2013-10-11 12:19:56,880 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1011')
2013-10-11 12:19:56,881 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1003')
2013-10-11 12:19:56,881 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1012')
2013-10-11 12:19:56,882 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0101')
2013-10-11 12:19:56,882 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1008')
2013-10-11 12:19:56,883 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1005')
2013-10-11 12:19:56,883 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1004')
2013-10-11 12:19:56,884 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100101')
2013-10-11 12:19:56,884 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100201')
2013-10-11 12:19:56,885 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100312')
2013-10-11 12:19:56,885 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100401')
2013-10-11 12:19:56,886 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100501')
2013-10-11 12:19:56,887 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100601')
2013-10-11 12:19:56,887 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100701')
2013-10-11 12:19:56,888 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100801')
2013-10-11 12:19:56,888 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100901')
2013-10-11 12:19:56,889 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101001')
2013-10-11 12:19:56,889 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101101')
2013-10-11 12:19:56,890 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101201')
2013-10-11 12:19:56,890 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101301')
2013-10-11 12:19:56,891 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','11')
2013-10-11 12:19:56,891 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1105')
2013-10-11 12:19:56,892 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1101')
2013-10-11 12:19:56,892 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1102')
2013-10-11 12:19:56,893 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1103')
2013-10-11 12:19:56,893 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1104')
2013-10-11 12:19:56,894 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1109')
2013-10-11 12:19:56,894 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','03')
2013-10-11 12:19:56,895 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0301')
2013-10-11 12:19:56,896 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0302')
2013-10-11 12:19:56,896 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0303')
2013-10-11 12:19:56,897 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0304')
2013-10-11 12:19:56,897 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','12')
2013-10-11 12:19:56,898 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1204')
2013-10-11 12:19:56,898 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1201')
2013-10-11 12:19:56,899 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1202')
2013-10-11 12:19:56,899 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1203')
2013-10-11 12:19:56,900 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','99')
2013-10-11 12:19:56,900 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9902')
2013-10-11 12:19:56,901 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9903')
2013-10-11 12:19:56,901 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9910')
2013-10-11 12:19:56,902 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9904')
2013-10-11 12:19:56,902 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9905')
2013-10-11 12:19:56,903 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9906')
2013-10-11 12:19:56,903 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9911')
2013-10-11 12:19:56,904 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9907')
2013-10-11 12:19:56,904 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','98')
2013-10-11 12:19:56,905 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9810')
2013-10-11 12:19:56,905 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9915')
2013-10-11 12:19:56,906 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9920')
2013-10-11 12:19:56,906 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9950')
2013-10-11 12:19:56,907 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9960')
2013-10-11 12:19:56,907 [10724] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9961')
2013-10-11 12:19:56,959 [10724] DEBUG Servicesys_role - 修改角色菜单按钮权限
2013-10-11 12:19:56,961 [10724] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'super'
2013-10-11 12:19:56,962 [10724] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','add')
2013-10-11 12:19:56,962 [10724] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','edit')
2013-10-11 12:19:56,963 [10724] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','delete')
2013-10-11 12:19:56,963 [10724] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','9960','add')
2013-10-11 12:19:56,964 [10724] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','9960','edit')
2013-10-11 12:19:56,964 [10724] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','9960','delete')
2013-10-11 12:19:56,965 [10724] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','9960','refresh')
2013-10-11 12:19:56,966 [10724] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','9960','download')
2013-10-11 12:19:56,966 [10724] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','9960','audit')
2013-10-11 12:19:57,031 [10724] DEBUG Servicesys_role - 修改角色数据权限
2013-10-11 12:19:57,032 [10724] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'super'
2013-10-11 12:19:57,033 [10724] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('super','0102','0')
2013-10-11 12:19:57,094 [10724] DEBUG Servicesys_role - 修改角色数据列权限
2013-10-11 12:19:57,097 [10724] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'super'
2013-10-11 12:19:57,099 [10724] DEBUG Sys - insert into sys_roleMenuColumnMap([RoleCode],[MenuCode],[IsReject],[FieldName]) values('super','1001','True','BillNo')
2013-10-11 12:20:01,242 [6008] DEBUG Servicepsi_purchase - 获取新主键
2013-10-11 12:20:01,242 [6008] DEBUG Psi - select isnull(max(BillNo),0) from psi_purchase
2013-10-11 12:20:01,290 [7732] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 12:20:01,299 [7732] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 12:20:01,300 [7732] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201310110003'
2013-10-11 12:20:01,347 [7732] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 12:20:01,377 [7732] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 12:20:01,379 [7732] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 12:20:01,382 [7732] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 12:20:01,382 [7732] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201310110003' order by BillNo desc
2013-10-11 12:20:01,385 [7732] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 12:20:01,385 [7732] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201310110003' order by BillNo
2013-10-11 12:20:01,388 [7732] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 12:20:01,388 [7732] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 12:20:03,352 [11420] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 12:20:03,352 [11420] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201310110003' order by A.RowId
2013-10-11 12:20:04,998 [6008] DEBUG Servicepsi_goods - 获取动态列表
2013-10-11 12:20:04,998 [6008] DEBUG Psi - select top 20 * from psi_goods order by Id
2013-10-11 12:20:05,072 [6008] DEBUG Psi - select count(*) from ( select * from psi_goods ) tb_temp
2013-10-11 12:20:08,032 [9120] DEBUG Servicepsi_purchaseGoods - 获取新主键
2013-10-11 12:20:08,033 [9120] DEBUG Psi - select isnull(max(RowId),0) from psi_purchaseGoods  where 1 = 1 
2013-10-11 12:20:08,036 [9120] DEBUG Psi - select isnull(max(RowId),0) from psi_purchaseGoods  where 1 = 1 
2013-10-11 12:20:17,840 [6008] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 12:20:17,840 [6008] DEBUG Psi - select top 20 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   order by Id
2013-10-11 12:20:17,883 [6008] DEBUG Psi - select count(*) from ( select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   ) tb_temp
2013-10-11 12:20:19,607 [9120] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 12:20:19,607 [9120] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('S1001') order by Id
2013-10-11 12:20:21,639 [9120] DEBUG Servicepsi_purchase - 编辑记录
2013-10-11 12:20:21,640 [9120] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 12:20:21,640 [9120] DEBUG Psi - select 
        psi_purchase
    .* from 
        psi_purchase
     where  BillNo =  '201310110003'
2013-10-11 12:20:21,658 [9120] DEBUG Psi - update 
        psi_purchase
     set [BillDate] = '2013-10-11 12:20:01', [DoPerson] = '刘会胜', [DoDate] = '2013-10-11 12:20:01', [Supplier] = 'S1001', [ContractName] = '', [PurchaseDate] = '2013-10-11 12:20:01', [PurchasePerson] = '刘会胜', [TotalMoney] = '22.00', [Remark] = '', [AuditPerson] = '刘会胜', [AuditDate] = '2013-10-11 12:20:01', [AuditState] = 'Unapproved', [AuditReason] = '', [CreatePerson] = '刘会胜', [CreateDate] = '2013-10-11 12:20:01', [UpdatePerson] = '刘会胜', [UpdateDate] = '2013-10-11 12:20:21' where  BillNo =  '201310110003'
2013-10-11 12:20:21,881 [9120] ERROR Servicepsi_purchase - 编辑记录失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'TotalMoney' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.Execute() 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Data\Command\PartialClasses\Execute.cs:行号 9
   在 Zephyr.Data.BaseUpdateBuilder.Execute() 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Data\Builders\Update\BaseUpdateBuilder.cs:行号 29
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass55.<Edit>b__52() 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 87
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:a8dbb4f1-f950-4167-90a9-e942b141e7fb
2013-10-11 12:20:25,085 [9120] ERROR /api/psi/purchase/edit - System.Data.SqlClient.SqlException (0x80131904): 列名 'TotalMoney' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.Edit(RequestWrapper formWrapper, RequestWrapper listWrapper, JObject data) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 68
   在 CallSite.Target(Closure , CallSite , psi_purchaseService , RequestWrapper , RequestWrapper , Object )
   在 System.Dynamic.UpdateDelegates.UpdateAndExecute4[T0,T1,T2,T3,TRet](CallSite site, T0 arg0, T1 arg1, T2 arg2, T3 arg3)
   在 Zephyr.Areas.Psi.Controllers.PurchaseApiController.Edit(Object data) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Web\Areas\Psi\Controllers\PurchaseController.cs:行号 247
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClassf.<GetExecutor>b__9(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:a8dbb4f1-f950-4167-90a9-e942b141e7fb
2013-10-11 13:41:28,168 [5924] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 13:41:28,196 [5924] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 13:41:28,201 [5924] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 13:41:28,205 [5924] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 13:41:28,210 [5924] DEBUG Psi - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 13:41:28,216 [5924] DEBUG Psi - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 13:41:28,765 [8628] DEBUG Servicepsi_purchase - 编辑记录
2013-10-11 13:41:28,789 [8628] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 13:41:28,803 [8628] DEBUG Psi - select 
        psi_purchase
    .* from 
        psi_purchase
     where  BillNo =  '201310110003'
2013-10-11 13:41:28,947 [8628] DEBUG Psi - update 
        psi_purchase
     set [BillDate] = '2013-10-11 12:20:01', [DoPerson] = '刘会胜', [DoDate] = '2013-10-11 12:20:01', [Supplier] = 'S1001', [ContractName] = '', [PurchaseDate] = '2013-10-11 12:20:01', [PurchasePerson] = '刘会胜', [TotalMoney] = '22', [Remark] = '', [AuditPerson] = '刘会胜', [AuditDate] = '2013-10-11 12:20:01', [AuditState] = 'Unapproved', [AuditReason] = '', [CreatePerson] = '刘会胜', [CreateDate] = '2013-10-11 12:20:01', [UpdatePerson] = '刘会胜', [UpdateDate] = '2013-10-11 13:41:28' where  BillNo =  '201310110003'
2013-10-11 13:41:28,962 [8628] DEBUG Psi - insert into 
        psi_purchase
    ([BillNo],[BillDate],[DoPerson],[DoDate],[Supplier],[ContractName],[PurchaseDate],[PurchasePerson],[TotalMoney],[Remark],[AuditPerson],[AuditDate],[AuditState],[AuditReason],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('201310110003','2013-10-11 12:20:01','刘会胜','2013-10-11 12:20:01','S1001','','2013-10-11 12:20:01','刘会胜','22','','刘会胜','2013-10-11 12:20:01','Unapproved','','刘会胜','2013-10-11 13:41:28','刘会胜','2013-10-11 13:41:28')
2013-10-11 13:41:28,996 [8628] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 13:41:28,997 [8628] DEBUG Psi - select 
        psi_purchaseGoods
    .* from 
        psi_purchaseGoods
     where  BillNo =  '201310110003'and RowId =  '1'
2013-10-11 13:41:29,025 [8628] DEBUG Psi - insert into 
        psi_purchaseGoods
    ([BillNo],[RowId],[GoodNo],[Num],[UnitPrice],[Money],[Remark],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('201310110003','1','1001','1','0','0','微毒','刘会胜','2013-10-11 13:41:29','刘会胜','2013-10-11 13:41:29')
2013-10-11 13:41:29,031 [8628] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 13:41:29,031 [8628] DEBUG Psi - select 
        psi_purchaseGoods
    .* from 
        psi_purchaseGoods
     where  BillNo =  '201310110003'and RowId =  '2'
2013-10-11 13:41:29,032 [8628] DEBUG Psi - insert into 
        psi_purchaseGoods
    ([BillNo],[RowId],[GoodNo],[Num],[UnitPrice],[Money],[Remark],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('201310110003','2','1002','2','11.00','22.00','22','刘会胜','2013-10-11 13:41:29','刘会胜','2013-10-11 13:41:29')
2013-10-11 13:41:35,508 [9952] DEBUG Servicepsi_purchase - 获取新主键
2013-10-11 13:41:35,515 [9952] DEBUG Psi - select isnull(max(BillNo),0) from psi_purchase
2013-10-11 13:41:35,644 [10056] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 13:41:35,665 [10056] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 13:41:35,665 [10056] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201310110004'
2013-10-11 13:41:35,679 [10056] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 13:41:35,708 [10056] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:41:35,710 [10056] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 13:41:35,712 [10056] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:41:35,712 [10056] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201310110004' order by BillNo desc
2013-10-11 13:41:35,715 [10056] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:41:35,715 [10056] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201310110004' order by BillNo
2013-10-11 13:41:35,718 [10056] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:41:35,718 [10056] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 13:41:38,024 [1628] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:41:38,025 [1628] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201310110004' order by A.RowId
2013-10-11 13:41:39,389 [8636] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 13:41:39,389 [8636] DEBUG Psi - select top 20 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   order by Id
2013-10-11 13:41:39,401 [8636] DEBUG Psi - select count(*) from ( select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   ) tb_temp
2013-10-11 13:41:40,352 [1268] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 13:41:40,352 [1268] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000003') order by Id
2013-10-11 13:41:43,700 [5404] DEBUG Servicepsi_goods - 获取动态列表
2013-10-11 13:41:43,700 [5404] DEBUG Psi - select top 20 * from psi_goods order by Id
2013-10-11 13:41:43,713 [5404] DEBUG Psi - select count(*) from ( select * from psi_goods ) tb_temp
2013-10-11 13:41:45,707 [8628] DEBUG Servicepsi_purchaseGoods - 获取新主键
2013-10-11 13:41:45,707 [8628] DEBUG Psi - select isnull(max(RowId),0) from psi_purchaseGoods  where 1 = 1 
2013-10-11 13:41:45,710 [8628] DEBUG Psi - select isnull(max(RowId),0) from psi_purchaseGoods  where 1 = 1 
2013-10-11 13:41:47,077 [9952] DEBUG Servicepsi_purchase - 编辑记录
2013-10-11 13:41:47,077 [9952] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 13:41:47,078 [9952] DEBUG Psi - select 
        psi_purchase
    .* from 
        psi_purchase
     where  BillNo =  '201310110004'
2013-10-11 13:41:47,080 [9952] DEBUG Psi - update 
        psi_purchase
     set [BillDate] = '2013-10-11 13:41:35', [DoPerson] = '刘会胜', [DoDate] = '2013-10-11 13:41:35', [Supplier] = '000003', [ContractName] = '', [PurchaseDate] = '2013-10-11 13:41:35', [PurchasePerson] = '刘会胜', [TotalMoney] = '0', [Remark] = '', [AuditPerson] = '刘会胜', [AuditDate] = '2013-10-11 13:41:35', [AuditState] = 'Unapproved', [AuditReason] = '', [CreatePerson] = '刘会胜', [CreateDate] = '2013-10-11 13:41:35', [UpdatePerson] = '刘会胜', [UpdateDate] = '2013-10-11 13:41:47' where  BillNo =  '201310110004'
2013-10-11 13:41:47,087 [9952] DEBUG Psi - insert into 
        psi_purchase
    ([BillNo],[BillDate],[DoPerson],[DoDate],[Supplier],[ContractName],[PurchaseDate],[PurchasePerson],[TotalMoney],[Remark],[AuditPerson],[AuditDate],[AuditState],[AuditReason],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('201310110004','2013-10-11 13:41:35','刘会胜','2013-10-11 13:41:35','000003','','2013-10-11 13:41:35','刘会胜','0','','刘会胜','2013-10-11 13:41:35','Unapproved','','刘会胜','2013-10-11 13:41:47','刘会胜','2013-10-11 13:41:47')
2013-10-11 13:41:47,090 [9952] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 13:41:47,090 [9952] DEBUG Psi - select 
        psi_purchaseGoods
    .* from 
        psi_purchaseGoods
     where  BillNo =  '201310110004'and RowId =  '25'
2013-10-11 13:41:47,091 [9952] DEBUG Psi - insert into 
        psi_purchaseGoods
    ([BillNo],[RowId],[GoodNo],[Num],[UnitPrice],[Money],[Remark],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('201310110004','25','1002','1','0','0','','刘会胜','2013-10-11 13:41:47','刘会胜','2013-10-11 13:41:47')
2013-10-11 13:41:47,093 [9952] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 13:41:47,093 [9952] DEBUG Psi - select 
        psi_purchaseGoods
    .* from 
        psi_purchaseGoods
     where  BillNo =  '201310110004'and RowId =  '26'
2013-10-11 13:41:47,094 [9952] DEBUG Psi - insert into 
        psi_purchaseGoods
    ([BillNo],[RowId],[GoodNo],[Num],[UnitPrice],[Money],[Remark],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('201310110004','26','101003','1','0','0','微毒','刘会胜','2013-10-11 13:41:47','刘会胜','2013-10-11 13:41:47')
2013-10-11 13:41:48,670 [4180] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 13:41:48,670 [4180] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201310110003'
2013-10-11 13:41:48,677 [4180] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 13:41:48,678 [4180] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:41:48,678 [4180] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 13:41:48,678 [4180] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:41:48,679 [4180] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201310110003' order by BillNo desc
2013-10-11 13:41:48,680 [4180] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:41:48,681 [4180] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201310110003' order by BillNo
2013-10-11 13:41:48,682 [4180] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:41:48,682 [4180] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 13:41:48,912 [5404] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:41:48,913 [10056] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 13:41:48,913 [5404] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201310110003' order by B.Unit desc
2013-10-11 13:41:48,913 [10056] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('S1001') order by Id
2013-10-11 13:41:49,943 [1628] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 13:41:49,943 [1628] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201310110004'
2013-10-11 13:41:49,945 [1628] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 13:41:49,945 [1628] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:41:49,945 [1628] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 13:41:49,946 [1628] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:41:49,946 [1628] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201310110004' order by BillNo desc
2013-10-11 13:41:49,946 [1628] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:41:49,946 [1628] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201310110004' order by BillNo
2013-10-11 13:41:49,946 [1628] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:41:49,946 [1628] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 13:41:49,970 [1268] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:41:49,970 [1268] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201310110004' order by B.Unit desc
2013-10-11 13:41:50,023 [4180] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 13:41:50,023 [4180] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000003') order by Id
2013-10-11 13:46:13,933 [1268] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Psi/purchase/Index','/Psi/purchase')
2013-10-11 13:46:14,583 [10056] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:46:14,583 [10056] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 13:46:14,589 [10056] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 13:46:25,521 [7468] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/user/Index','/Sys/user')
2013-10-11 13:46:27,316 [5404] DEBUG Servicesys_user - 获取实体列表
2013-10-11 13:46:27,321 [5404] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2013-10-11 13:46:27,339 [1628] DEBUG Servicesys_organize - 获取实体列表
2013-10-11 13:46:27,340 [1628] DEBUG Sys - select sys_organize.* from sys_organize
2013-10-11 13:46:27,357 [5404] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2013-10-11 13:47:14,686 [5924] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 13:47:14,703 [5924] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 13:47:14,708 [5924] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 13:47:14,708 [5924] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 13:47:14,713 [5924] DEBUG Psi - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 13:47:14,713 [5924] DEBUG Psi - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 13:47:15,025 [6992] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/role/Index','/Sys/role')
2013-10-11 13:47:15,028 [616] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/permission/Index','/Sys/permission')
2013-10-11 13:47:15,054 [6992] DEBUG Servicesys_user - 获取动态列表
2013-10-11 13:47:15,068 [6992] DEBUG Sys - select UserCode,UserName from sys_user
2013-10-11 13:47:15,070 [6992] DEBUG Servicesys_organize - 获取动态列表
2013-10-11 13:47:15,071 [6992] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2013-10-11 13:47:18,449 [10056] DEBUG Servicesys_permission - 获取动态列表
2013-10-11 13:47:18,449 [10056] DEBUG Sys - select A.*,B.PermissionName as ParentName from sys_permission A left join sys_permission B on B.PermissionCode = A.ParentCode
2013-10-11 13:47:18,460 [9524] DEBUG Servicesys_role - 获取实体列表
2013-10-11 13:47:18,465 [9524] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2013-10-11 13:48:41,584 [6992] DEBUG Servicesys_role - 编辑记录
2013-10-11 13:48:41,602 [6992] DEBUG Servicesys_role - 获取动态对象
2013-10-11 13:48:41,607 [6992] DEBUG Sys - select 
        sys_role
    .* from 
        sys_role
     where  RoleCode =  ''
2013-10-11 13:48:41,634 [6992] DEBUG Sys - insert into 
        sys_role
    ([UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('刘会胜','2013-10-11 13:48:41','刘会胜','2013-10-11 13:48:41')
2013-10-11 13:48:41,649 [6992] ERROR Servicesys_role - 编辑记录失败
System.Data.SqlClient.SqlException (0x80131904): 不能将值 NULL 插入列 'RoleCode'，表 'Zephyr.Sys.dbo.sys_role'；列不允许有空值。INSERT 失败。
语句已终止。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.Execute() 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Data\Command\PartialClasses\Execute.cs:行号 9
   在 Zephyr.Data.BaseInsertBuilder.Execute() 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Data\Builders\Insert\BaseInsertBuilder.cs:行号 22
   在 Zephyr.Core.ServiceBase`1.<Edit>b__51(RequestWrapper x) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 62
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass55.<Edit>b__52() 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 119
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:d7c7bf0b-18d2-4ee5-a65d-ecb5a0ba09f5
2013-10-11 13:48:41,701 [6992] ERROR /api/sys/role/edit - System.Data.SqlClient.SqlException (0x80131904): 不能将值 NULL 插入列 'RoleCode'，表 'Zephyr.Sys.dbo.sys_role'；列不允许有空值。INSERT 失败。
语句已终止。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.Edit(RequestWrapper formWrapper, RequestWrapper listWrapper, JObject data) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 68
   在 CallSite.Target(Closure , CallSite , sys_roleService , Object , RequestWrapper , Object )
   在 System.Dynamic.UpdateDelegates.UpdateAndExecute4[T0,T1,T2,T3,TRet](CallSite site, T0 arg0, T1 arg1, T2 arg2, T3 arg3)
   在 Zephyr.Areas.Sys.Controllers.RoleApiController.Edit(Object data) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Web\Areas\Sys\Controllers\RoleController.cs:行号 70
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClassf.<GetExecutor>b__9(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:d7c7bf0b-18d2-4ee5-a65d-ecb5a0ba09f5
2013-10-11 13:48:47,372 [10056] DEBUG Servicesys_role - 编辑记录
2013-10-11 13:48:47,374 [10056] DEBUG Servicesys_role - 获取动态对象
2013-10-11 13:48:47,374 [10056] DEBUG Sys - select 
        sys_role
    .* from 
        sys_role
     where  RoleCode =  ''
2013-10-11 13:48:47,376 [10056] DEBUG Sys - insert into 
        sys_role
    ([RoleName],[RoleCode],[RoleSeq],[Description],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('材料管理人员','R7','100','','刘会胜','2013-10-11 13:48:47','刘会胜','2013-10-11 13:48:47')
2013-10-11 13:48:47,478 [10644] DEBUG Servicesys_role - 获取实体列表
2013-10-11 13:48:47,478 [10644] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2013-10-11 13:49:05,898 [616] DEBUG Servicesys_role - 编辑记录
2013-10-11 13:49:05,898 [616] DEBUG Servicesys_role - 获取动态对象
2013-10-11 13:49:05,900 [616] DEBUG Sys - select 
        sys_role
    .* from 
        sys_role
     where  RoleCode =  'R7'
2013-10-11 13:49:05,913 [616] DEBUG Sys - update 
        sys_role
     set [RoleName] = '材料管理人员', [RoleCode] = 'R7', [RoleSeq] = '91', [Description] = '', [UpdatePerson] = '刘会胜', [UpdateDate] = '2013-10-11 13:49:05' where  RoleCode =  'R7'
2013-10-11 13:49:05,986 [9524] DEBUG Servicesys_role - 获取实体列表
2013-10-11 13:49:05,986 [9524] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2013-10-11 13:49:09,127 [11156] DEBUG Servicesys_permission - 获取动态列表
2013-10-11 13:49:09,127 [11156] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R7' and B.PermissionCode = A.PermissionCode 
2013-10-11 13:49:09,131 [6992] DEBUG Sys - select * from sys_button order by ButtonSeq
2013-10-11 13:49:09,145 [6992] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R7' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R7'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R7'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R7'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R7'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R7'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R7'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R7'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R7'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R7'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R7'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R7'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R7'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R7'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R7'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2013-10-11 13:49:09,292 [6992] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R7'
2013-10-11 13:49:16,891 [1104] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2013-10-11 13:49:18,161 [11156] DEBUG Servicesys_menu - 获取动态列表
2013-10-11 13:49:18,162 [11156] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2013-10-11 13:49:28,262 [6992] DEBUG Servicesys_menu - 编辑记录
2013-10-11 13:49:28,262 [6992] DEBUG Servicesys_menu - 获取动态对象
2013-10-11 13:49:28,263 [6992] DEBUG Sys - select 
        sys_menu
    .* from 
        sys_menu
     where  MenuCode =  '1019'
2013-10-11 13:49:28,268 [6992] DEBUG Sys - update 
        sys_menu
     set [MenuName] = '采购明细', [MenuCode] = '1019', [ParentCode] = '10', [IconClass] = '', [URL] = '/psi/purchase/edit', [IsVisible] = 'false', [IsEnable] = 'true', [MenuSeq] = '', [UpdatePerson] = '刘会胜', [UpdateDate] = '2013-10-11 13:49:28' where  MenuCode =  '1019'
2013-10-11 13:49:28,295 [6992] DEBUG Sys - insert into sys_log([UserCode],[UserName],[Position],[Target],[Type],[Message],[Date]) values('lhs','刘会胜','api/mms/send','菜单数据','修改','{"list":{"deleted":[],"inserted":[],"updated":[{"_id":"1019","MenuName":"采购明细","MenuCode":"1019","ParentCode":"10","IconClass":"","URL":"/psi/purchase/edit","IsVisible":"false","IsEnable":"true","MenuSeq":""}],"_changed":true}}','2013-10-11 13:49:28')
2013-10-11 13:49:28,415 [10056] DEBUG Servicesys_menu - 获取动态列表
2013-10-11 13:49:28,415 [10056] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2013-10-11 13:49:35,984 [8672] DEBUG Sys - select * from sys_button order by ButtonSeq
2013-10-11 13:49:35,985 [8672] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R7' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R7'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R7'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R7'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R7'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R7'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R7'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R7'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R7'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R7'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R7'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R7'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R7'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R7'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R7'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2013-10-11 13:49:36,034 [616] DEBUG Servicesys_permission - 获取动态列表
2013-10-11 13:49:36,035 [616] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R7' and B.PermissionCode = A.PermissionCode 
2013-10-11 13:49:36,057 [8672] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R7'
2013-10-11 13:49:44,598 [8672] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2013-10-11 13:49:44,920 [4804] DEBUG Servicesys_menu - 获取动态列表
2013-10-11 13:49:44,920 [4804] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2013-10-11 13:50:35,138 [9524] DEBUG Servicesys_menu - 编辑记录
2013-10-11 13:50:35,139 [9524] DEBUG Servicesys_menu - 获取动态对象
2013-10-11 13:50:35,139 [9524] DEBUG Sys - select 
        sys_menu
    .* from 
        sys_menu
     where  MenuCode =  '1019'
2013-10-11 13:50:35,140 [9524] DEBUG Sys - update 
        sys_menu
     set [MenuName] = '采购明细', [MenuCode] = '1019', [ParentCode] = '10', [IconClass] = '', [URL] = '/psi/purchase/edit', [IsVisible] = 'false', [IsEnable] = 'true', [MenuSeq] = '', [UpdatePerson] = '刘会胜', [UpdateDate] = '2013-10-11 13:50:35' where  MenuCode =  '1019'
2013-10-11 13:50:35,141 [9524] DEBUG Servicesys_menu - 获取动态对象
2013-10-11 13:50:35,141 [9524] DEBUG Sys - select 
        sys_menu
    .* from 
        sys_menu
     where  MenuCode =  '0101'
2013-10-11 13:50:35,142 [9524] DEBUG Sys - update 
        sys_menu
     set [MenuName] = '材料采购单', [MenuCode] = '0101', [ParentCode] = '10', [IconClass] = 'icon-application_osx_add', [URL] = '/psi/purchase', [IsVisible] = 'true', [IsEnable] = 'true', [MenuSeq] = '1010', [UpdatePerson] = '刘会胜', [UpdateDate] = '2013-10-11 13:50:35' where  MenuCode =  '0101'
2013-10-11 13:50:35,161 [9524] DEBUG Sys - insert into sys_log([UserCode],[UserName],[Position],[Target],[Type],[Message],[Date]) values('lhs','刘会胜','api/mms/send','菜单数据','修改','{"list":{"deleted":[],"inserted":[],"updated":[{"_id":"1019","MenuName":"采购明细","MenuCode":"1019","ParentCode":"10","IconClass":"","URL":"/psi/purchase/edit","IsVisible":"false","IsEnable":"true","MenuSeq":""},{"_id":"0101","MenuName":"材料采购单","MenuCode":"0101","ParentCode":"10","IconClass":"icon-application_osx_add","URL":"/psi/purchase","IsVisible":"true","IsEnable":"true","MenuSeq":"1010"}],"_changed":true}}','2013-10-11 13:50:35')
2013-10-11 13:50:35,292 [4804] DEBUG Servicesys_menu - 获取动态列表
2013-10-11 13:50:35,292 [4804] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2013-10-11 13:50:51,645 [4804] DEBUG Servicesys_menu - 编辑记录
2013-10-11 13:50:51,646 [4804] DEBUG Servicesys_menu - 获取动态对象
2013-10-11 13:50:51,646 [4804] DEBUG Sys - select 
        sys_menu
    .* from 
        sys_menu
     where  MenuCode =  '0101'
2013-10-11 13:50:51,647 [4804] DEBUG Sys - update 
        sys_menu
     set [MenuName] = '材料采购单', [MenuCode] = '0101', [ParentCode] = '10', [IconClass] = 'icon-application_osx_add', [URL] = '/psi/purchase', [IsVisible] = 'true', [IsEnable] = 'true', [MenuSeq] = '009', [UpdatePerson] = '刘会胜', [UpdateDate] = '2013-10-11 13:50:51' where  MenuCode =  '0101'
2013-10-11 13:50:51,658 [4804] DEBUG Sys - insert into sys_log([UserCode],[UserName],[Position],[Target],[Type],[Message],[Date]) values('lhs','刘会胜','api/mms/send','菜单数据','修改','{"list":{"deleted":[],"inserted":[],"updated":[{"_id":"0101","MenuName":"材料采购单","MenuCode":"0101","ParentCode":"10","IconClass":"icon-application_osx_add","URL":"/psi/purchase","IsVisible":"true","IsEnable":"true","MenuSeq":"009"}],"_changed":true}}','2013-10-11 13:50:51')
2013-10-11 13:50:51,766 [10056] DEBUG Servicesys_menu - 获取动态列表
2013-10-11 13:50:51,766 [10056] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2013-10-11 13:51:08,387 [616] DEBUG Sys - select * from sys_button order by ButtonSeq
2013-10-11 13:51:08,389 [616] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R7' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R7'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R7'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R7'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R7'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R7'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R7'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R7'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R7'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R7'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R7'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R7'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R7'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R7'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R7'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2013-10-11 13:51:08,428 [6992] DEBUG Servicesys_permission - 获取动态列表
2013-10-11 13:51:08,428 [6992] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R7' and B.PermissionCode = A.PermissionCode 
2013-10-11 13:51:08,457 [616] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R7'
2013-10-11 13:52:46,047 [9524] DEBUG Servicesys_role - 修改角色菜单权限
2013-10-11 13:52:46,051 [9524] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'R7'
2013-10-11 13:52:46,054 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','10')
2013-10-11 13:52:46,056 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1019')
2013-10-11 13:52:46,059 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','0101')
2013-10-11 13:52:46,060 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1002')
2013-10-11 13:52:46,060 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1001')
2013-10-11 13:52:46,060 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1009')
2013-10-11 13:52:46,061 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1010')
2013-10-11 13:52:46,061 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1013')
2013-10-11 13:52:46,062 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1007')
2013-10-11 13:52:46,062 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1006')
2013-10-11 13:52:46,063 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1011')
2013-10-11 13:52:46,063 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1003')
2013-10-11 13:52:46,064 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1012')
2013-10-11 13:52:46,064 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1008')
2013-10-11 13:52:46,065 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1005')
2013-10-11 13:52:46,065 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1004')
2013-10-11 13:52:46,065 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','100101')
2013-10-11 13:52:46,068 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','100201')
2013-10-11 13:52:46,068 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','100312')
2013-10-11 13:52:46,069 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','100401')
2013-10-11 13:52:46,069 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','100501')
2013-10-11 13:52:46,070 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','100601')
2013-10-11 13:52:46,070 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','100701')
2013-10-11 13:52:46,071 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','100801')
2013-10-11 13:52:46,071 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','100901')
2013-10-11 13:52:46,071 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','101001')
2013-10-11 13:52:46,072 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','101101')
2013-10-11 13:52:46,072 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','101201')
2013-10-11 13:52:46,073 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','101301')
2013-10-11 13:52:46,073 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','11')
2013-10-11 13:52:46,074 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1105')
2013-10-11 13:52:46,074 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1101')
2013-10-11 13:52:46,074 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1102')
2013-10-11 13:52:46,075 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1103')
2013-10-11 13:52:46,075 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1104')
2013-10-11 13:52:46,076 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1109')
2013-10-11 13:52:46,076 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','12')
2013-10-11 13:52:46,077 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1204')
2013-10-11 13:52:46,077 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1201')
2013-10-11 13:52:46,078 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1202')
2013-10-11 13:52:46,078 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1203')
2013-10-11 13:52:46,078 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','99')
2013-10-11 13:52:46,079 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','9902')
2013-10-11 13:52:46,079 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','9903')
2013-10-11 13:52:46,079 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','9910')
2013-10-11 13:52:46,080 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','9904')
2013-10-11 13:52:46,080 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','9905')
2013-10-11 13:52:46,080 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','9906')
2013-10-11 13:52:46,081 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','9911')
2013-10-11 13:52:46,081 [9524] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','9907')
2013-10-11 13:52:46,095 [9524] DEBUG Servicesys_role - 修改角色菜单按钮权限
2013-10-11 13:52:46,096 [9524] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'R7'
2013-10-11 13:52:46,102 [9524] DEBUG Servicesys_role - 修改角色数据权限
2013-10-11 13:52:46,103 [9524] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'R7'
2013-10-11 13:52:46,108 [9524] DEBUG Servicesys_role - 修改角色数据列权限
2013-10-11 13:52:46,112 [9524] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'R7'
2013-10-11 13:52:48,944 [11456] DEBUG Sys - select * from sys_userSetting where UserCode='lhs'
2013-10-11 13:52:51,351 [6992] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'lhs' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'lhs'
  )  
)
order by B.MenuSeq,B.MenuCode
2013-10-11 13:52:51,976 [8672] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/role/Index','/Sys/role')
2013-10-11 13:52:51,978 [8672] DEBUG Servicesys_user - 获取动态列表
2013-10-11 13:52:51,978 [8672] DEBUG Sys - select UserCode,UserName from sys_user
2013-10-11 13:52:51,979 [8672] DEBUG Servicesys_organize - 获取动态列表
2013-10-11 13:52:51,979 [8672] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2013-10-11 13:52:52,381 [616] DEBUG Servicesys_role - 获取实体列表
2013-10-11 13:52:52,382 [616] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2013-10-11 13:52:55,124 [616] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2013-10-11 13:52:55,139 [616] DEBUG Servicemms_warehouse - 获取动态列表
2013-10-11 13:52:55,140 [616] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2013-10-11 13:52:55,142 [616] DEBUG Servicesys_code - 获取动态列表
2013-10-11 13:52:55,143 [616] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2013-10-11 13:52:56,637 [9524] DEBUG Servicemms_receive - 获取动态列表
2013-10-11 13:52:56,638 [9524] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2013-10-11 13:52:56,660 [9524] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2013-10-11 13:52:57,569 [10644] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/send/Index','/Mms/send')
2013-10-11 13:52:57,579 [10644] DEBUG Servicemms_warehouse - 获取动态列表
2013-10-11 13:52:57,580 [10644] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2013-10-11 13:52:57,585 [10644] DEBUG Servicesys_code - 获取动态列表
2013-10-11 13:52:57,585 [10644] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2013-10-11 13:52:57,586 [10644] DEBUG Servicesys_code - 获取动态列表
2013-10-11 13:52:57,586 [10644] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2013-10-11 13:52:58,433 [10644] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2013-10-11 13:52:58,437 [10644] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'lhs'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'lhs'
)
2013-10-11 13:52:58,474 [10644] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2013-10-11 13:52:58,475 [10644] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'lhs'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'lhs'
)
order by ButtonSeq
2013-10-11 13:52:59,183 [8672] DEBUG Servicemms_send - 获取动态列表
2013-10-11 13:52:59,183 [8672] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2013-10-11 13:52:59,384 [8672] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2013-10-11 13:53:05,685 [9524] DEBUG Sys - select * from sys_button order by ButtonSeq
2013-10-11 13:53:05,687 [9524] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='R7' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='R7'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='R7'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='R7'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='R7'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='R7'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='R7'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='R7'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='R7'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='R7'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='R7'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='R7'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='R7'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='R7'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='R7'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2013-10-11 13:53:05,741 [11456] DEBUG Servicesys_permission - 获取动态列表
2013-10-11 13:53:05,741 [11456] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='R7' and B.PermissionCode = A.PermissionCode 
2013-10-11 13:53:05,758 [9524] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'R7'
2013-10-11 13:53:32,678 [8672] DEBUG Servicesys_role - 修改角色菜单权限
2013-10-11 13:53:32,678 [8672] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'R7'
2013-10-11 13:53:32,679 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','10')
2013-10-11 13:53:32,680 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1019')
2013-10-11 13:53:32,681 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','0101')
2013-10-11 13:53:32,681 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1002')
2013-10-11 13:53:32,682 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1001')
2013-10-11 13:53:32,682 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1009')
2013-10-11 13:53:32,682 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1010')
2013-10-11 13:53:32,683 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1013')
2013-10-11 13:53:32,683 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1007')
2013-10-11 13:53:32,684 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1006')
2013-10-11 13:53:32,684 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1011')
2013-10-11 13:53:32,685 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1003')
2013-10-11 13:53:32,685 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1012')
2013-10-11 13:53:32,686 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1008')
2013-10-11 13:53:32,686 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1005')
2013-10-11 13:53:32,687 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1004')
2013-10-11 13:53:32,687 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','100101')
2013-10-11 13:53:32,688 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','100201')
2013-10-11 13:53:32,688 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','100312')
2013-10-11 13:53:32,689 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','100401')
2013-10-11 13:53:32,689 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','100501')
2013-10-11 13:53:32,690 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','100601')
2013-10-11 13:53:32,690 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','100701')
2013-10-11 13:53:32,691 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','100801')
2013-10-11 13:53:32,691 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','100901')
2013-10-11 13:53:32,692 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','101001')
2013-10-11 13:53:32,692 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','101101')
2013-10-11 13:53:32,693 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','101201')
2013-10-11 13:53:32,693 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','101301')
2013-10-11 13:53:32,694 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','11')
2013-10-11 13:53:32,694 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1105')
2013-10-11 13:53:32,695 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1101')
2013-10-11 13:53:32,695 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1102')
2013-10-11 13:53:32,696 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1103')
2013-10-11 13:53:32,696 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1104')
2013-10-11 13:53:32,697 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1109')
2013-10-11 13:53:32,697 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','12')
2013-10-11 13:53:32,698 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1204')
2013-10-11 13:53:32,698 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1201')
2013-10-11 13:53:32,699 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1202')
2013-10-11 13:53:32,699 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','1203')
2013-10-11 13:53:32,700 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','99')
2013-10-11 13:53:32,700 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','9902')
2013-10-11 13:53:32,701 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','9903')
2013-10-11 13:53:32,701 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','9910')
2013-10-11 13:53:32,702 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','9904')
2013-10-11 13:53:32,702 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','9905')
2013-10-11 13:53:32,703 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','9906')
2013-10-11 13:53:32,703 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','9911')
2013-10-11 13:53:32,704 [8672] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('R7','9907')
2013-10-11 13:53:32,711 [8672] DEBUG Servicesys_role - 修改角色菜单按钮权限
2013-10-11 13:53:32,711 [8672] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'R7'
2013-10-11 13:53:32,712 [8672] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R7','1001','add')
2013-10-11 13:53:32,715 [8672] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R7','1001','edit')
2013-10-11 13:53:32,718 [8672] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R7','1001','delete')
2013-10-11 13:53:32,722 [8672] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R7','1001','download')
2013-10-11 13:53:32,726 [8672] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('R7','1001','audit')
2013-10-11 13:53:32,730 [8672] DEBUG Servicesys_role - 修改角色数据权限
2013-10-11 13:53:32,730 [8672] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'R7'
2013-10-11 13:53:32,731 [8672] DEBUG Servicesys_role - 修改角色数据列权限
2013-10-11 13:53:32,731 [8672] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'R7'
2013-10-11 13:53:41,305 [8672] DEBUG Servicesys_user - 获取实体对象
2013-10-11 13:53:41,308 [8672] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'admin'and Password =  '1234'and IsEnable =  'True'
2013-10-11 13:53:41,317 [8672] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2013-10-11 13:53:41,338 [8672] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','LHS-PC','27.154.21.0/localhost','福建省厦门市','2013-10-11 13:53:41')
2013-10-11 13:53:41,342 [8672] DEBUG Servicemms_project - 获取实体对象
2013-10-11 13:53:41,343 [8672] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2013-10-11 13:53:41,374 [10644] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2013-10-11 13:53:41,554 [616] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2013-10-11 13:53:51,641 [9524] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/user/Index','/Sys/user')
2013-10-11 13:53:52,732 [6992] DEBUG Servicesys_user - 获取实体列表
2013-10-11 13:53:52,732 [6992] DEBUG Sys - select top 20 sys_user.* from sys_user order by UserSeq
2013-10-11 13:53:52,733 [10644] DEBUG Servicesys_organize - 获取实体列表
2013-10-11 13:53:52,734 [10644] DEBUG Sys - select sys_organize.* from sys_organize
2013-10-11 13:53:52,760 [6992] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2013-10-11 13:53:58,212 [8672] DEBUG Sys - 
select distinct A.OrganizeCode,A.OrganizeName,A.ParentCode
,(case when B.UserCode is null then 'false' else 'true' end) as Checked
from sys_organize A
left join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode and B.UserCode = 'admin'
2013-10-11 13:54:01,565 [10644] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'admin'
2013-10-11 13:54:06,952 [7864] DEBUG Servicesys_user - 设置用户角色
2013-10-11 13:54:06,955 [7864] DEBUG Sys - delete from sys_userRoleMap where [UserCode] = 'admin'
2013-10-11 13:54:06,957 [7864] DEBUG Sys - insert into sys_userRoleMap([UserCode],[RoleCode]) values('admin','R7')
2013-10-11 13:54:09,566 [6992] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/role/Index','/Sys/role')
2013-10-11 13:54:09,576 [6992] DEBUG Servicesys_user - 获取动态列表
2013-10-11 13:54:09,576 [6992] DEBUG Sys - select UserCode,UserName from sys_user
2013-10-11 13:54:09,576 [6992] DEBUG Servicesys_organize - 获取动态列表
2013-10-11 13:54:09,577 [6992] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2013-10-11 13:54:09,892 [8672] DEBUG Servicesys_role - 获取实体列表
2013-10-11 13:54:09,893 [8672] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2013-10-11 13:54:15,277 [4804] DEBUG Servicesys_role - 编辑记录
2013-10-11 13:54:15,278 [4804] DEBUG Servicesys_role - 获取动态对象
2013-10-11 13:54:15,278 [4804] DEBUG Sys - select 
        sys_role
    .* from 
        sys_role
     where  RoleCode =  'R7'
2013-10-11 13:54:15,279 [4804] DEBUG Sys - update 
        sys_role
     set [RoleName] = '材料管理员', [RoleCode] = 'R7', [RoleSeq] = '91', [Description] = '', [UpdatePerson] = '管理员', [UpdateDate] = '2013-10-11 13:54:15' where  RoleCode =  'R7'
2013-10-11 13:54:15,407 [10644] DEBUG Servicesys_role - 获取实体列表
2013-10-11 13:54:15,407 [10644] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2013-10-11 13:54:17,864 [9788] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2013-10-11 13:54:18,107 [616] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2013-10-11 13:54:18,574 [4804] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/role/Index','/Sys/role')
2013-10-11 13:54:18,576 [4804] DEBUG Servicesys_user - 获取动态列表
2013-10-11 13:54:18,577 [4804] DEBUG Sys - select UserCode,UserName from sys_user
2013-10-11 13:54:18,577 [4804] DEBUG Servicesys_organize - 获取动态列表
2013-10-11 13:54:18,577 [4804] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2013-10-11 13:54:19,039 [9788] DEBUG Servicesys_role - 获取实体列表
2013-10-11 13:54:19,040 [9788] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2013-10-11 13:54:24,918 [616] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/Index','/Psi/purchase')
2013-10-11 13:54:24,988 [4804] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/Index','/Psi/purchase')
2013-10-11 13:54:26,347 [9524] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:54:26,354 [9524] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 13:54:26,363 [9524] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 13:54:32,896 [11456] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 13:54:32,913 [11456] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 13:54:32,914 [11456] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201305110003'
2013-10-11 13:54:32,925 [11456] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 13:54:32,949 [11456] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:54:32,951 [11456] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 13:54:32,953 [11456] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:54:32,953 [11456] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201305110003' order by BillNo desc
2013-10-11 13:54:32,956 [11456] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:54:32,956 [11456] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201305110003' order by BillNo
2013-10-11 13:54:32,958 [11456] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:54:32,958 [11456] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 13:54:33,904 [7864] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 13:54:33,905 [7864] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000002') order by Id
2013-10-11 13:54:34,311 [616] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:54:34,311 [616] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201305110003' order by A.RowId
2013-10-11 13:54:52,373 [7864] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 13:54:52,376 [7864] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 13:54:52,377 [7864] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201305110004'
2013-10-11 13:54:52,379 [7864] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 13:54:52,379 [7864] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:54:52,379 [7864] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 13:54:52,380 [7864] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:54:52,380 [7864] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201305110004' order by BillNo desc
2013-10-11 13:54:52,381 [7864] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:54:52,382 [7864] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201305110004' order by BillNo
2013-10-11 13:54:52,383 [7864] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:54:52,383 [7864] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 13:54:53,129 [616] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 13:54:53,129 [616] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000002') order by Id
2013-10-11 13:54:53,469 [8672] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:54:53,469 [8672] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201305110004' order by A.RowId
2013-10-11 13:54:56,238 [9788] DEBUG Servicepsi_goods - 获取动态列表
2013-10-11 13:54:56,239 [9788] DEBUG Psi - select top 20 * from psi_goods order by Id
2013-10-11 13:54:56,247 [9788] DEBUG Psi - select count(*) from ( select * from psi_goods ) tb_temp
2013-10-11 13:55:31,076 [11456] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2013-10-11 13:55:31,086 [11456] DEBUG Servicemms_warehouse - 获取动态列表
2013-10-11 13:55:31,086 [11456] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2013-10-11 13:55:31,087 [11456] DEBUG Servicesys_code - 获取动态列表
2013-10-11 13:55:31,087 [11456] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2013-10-11 13:55:31,655 [10644] DEBUG Servicemms_receive - 获取动态列表
2013-10-11 13:55:31,656 [10644] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2013-10-11 13:55:31,658 [10644] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2013-10-11 13:55:33,629 [6564] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/Index','/Psi/purchase')
2013-10-11 13:55:34,148 [8672] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:55:34,148 [8672] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 13:55:34,149 [8672] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 13:55:37,680 [10644] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2013-10-11 13:55:37,686 [10644] DEBUG Servicemms_warehouse - 获取动态列表
2013-10-11 13:55:37,686 [10644] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2013-10-11 13:55:37,687 [10644] DEBUG Servicesys_code - 获取动态列表
2013-10-11 13:55:37,687 [10644] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2013-10-11 13:55:38,330 [616] DEBUG Servicemms_receive - 获取动态列表
2013-10-11 13:55:38,330 [616] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2013-10-11 13:55:38,332 [616] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2013-10-11 13:56:14,218 [10644] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/Index','/Psi/purchase')
2013-10-11 13:56:14,717 [9524] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:56:14,717 [9524] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 13:56:14,718 [9524] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 13:56:17,369 [9536] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 13:56:17,371 [9536] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 13:56:17,372 [9536] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201305110004'
2013-10-11 13:56:17,374 [9536] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 13:56:17,375 [9536] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:56:17,375 [9536] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 13:56:17,375 [9536] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:56:17,375 [9536] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201305110004' order by BillNo desc
2013-10-11 13:56:17,376 [9536] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:56:17,376 [9536] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201305110004' order by BillNo
2013-10-11 13:56:17,376 [9536] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:56:17,376 [9536] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 13:56:18,097 [616] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 13:56:18,097 [616] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000002') order by Id
2013-10-11 13:56:18,401 [10644] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:56:18,402 [10644] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201305110004' order by A.RowId
2013-10-11 13:56:27,073 [10644] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2013-10-11 13:56:27,078 [10644] DEBUG Servicemms_warehouse - 获取动态列表
2013-10-11 13:56:27,079 [10644] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2013-10-11 13:56:27,079 [10644] DEBUG Servicesys_code - 获取动态列表
2013-10-11 13:56:27,079 [10644] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2013-10-11 13:56:27,610 [616] DEBUG Servicemms_receive - 获取动态列表
2013-10-11 13:56:27,611 [616] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2013-10-11 13:56:27,613 [616] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2013-10-11 13:56:28,297 [6564] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/edit')
2013-10-11 13:56:28,311 [6564] DEBUG Servicemms_receive - 获取实体对象
2013-10-11 13:56:28,312 [6564] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201307020016'
2013-10-11 13:56:28,318 [6564] DEBUG Servicemms_receive - 获取上一条下一条数据
2013-10-11 13:56:28,320 [6564] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:28,320 [6564] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2013-10-11 13:56:28,323 [6564] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:28,323 [6564] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201307020016'and ProjectCode =  '201306030001' order by BillNo desc
2013-10-11 13:56:28,326 [6564] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:28,326 [6564] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201307020016'and ProjectCode =  '201306030001' order by BillNo
2013-10-11 13:56:28,329 [6564] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:28,329 [6564] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2013-10-11 13:56:28,371 [6564] DEBUG Servicesys_code - 获取动态列表
2013-10-11 13:56:28,371 [6564] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2013-10-11 13:56:28,373 [6564] DEBUG Servicesys_code - 获取动态列表
2013-10-11 13:56:28,373 [6564] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2013-10-11 13:56:28,374 [6564] DEBUG Servicesys_code - 获取动态列表
2013-10-11 13:56:28,374 [6564] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2013-10-11 13:56:28,375 [6564] DEBUG Servicemms_warehouse - 获取动态列表
2013-10-11 13:56:28,375 [6564] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2013-10-11 13:56:28,376 [6564] DEBUG Servicesys_code - 获取字段
2013-10-11 13:56:28,377 [6564] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2013-10-11 13:56:28,379 [6564] DEBUG Servicesys_code - 获取字段
2013-10-11 13:56:28,379 [6564] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2013-10-11 13:56:29,177 [11456] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 13:56:29,177 [11456] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('CG00303') order by MerchantsCode
2013-10-11 13:56:29,441 [10352] DEBUG Servicemms_receive - 获取动态列表
2013-10-11 13:56:29,441 [10352] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201307020016' order by A.MaterialCode
2013-10-11 13:56:32,625 [7864] DEBUG Servicemms_materialType - 获取动态列表
2013-10-11 13:56:32,625 [7864] DEBUG Mms - select 
        MaterialTypeName as text,MaterialType as id,ParentCode as pid
     from 
        mms_materialType
     order by MaterialType
2013-10-11 13:56:32,687 [6564] DEBUG Servicemms_material - 获取动态列表
2013-10-11 13:56:32,688 [6564] DEBUG Mms - select top 10 A.* from 
    mms_material A
   order by A.MaterialCode
2013-10-11 13:56:32,699 [6564] DEBUG Mms - select count(*) from ( select A.* from 
    mms_material A
   ) tb_temp
2013-10-11 13:56:41,075 [9536] DEBUG Servicemms_receiveDetail - 获取新主键
2013-10-11 13:56:41,077 [9536] DEBUG Mms - select isnull(max(RowId),0) from mms_receiveDetail  where 1 = 1  and  BillNo =  '201307020016'
2013-10-11 13:56:41,086 [9536] DEBUG Mms - select isnull(max(RowId),0) from mms_receiveDetail  where 1 = 1  and  BillNo =  '201307020016'
2013-10-11 13:56:46,036 [6564] DEBUG Servicemms_receive - 获取实体对象
2013-10-11 13:56:46,037 [6564] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201307020022'
2013-10-11 13:56:46,038 [6564] DEBUG Servicemms_receive - 获取上一条下一条数据
2013-10-11 13:56:46,038 [6564] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:46,038 [6564] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2013-10-11 13:56:46,038 [6564] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:46,038 [6564] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201307020022'and ProjectCode =  '201306030001' order by BillNo desc
2013-10-11 13:56:46,041 [6564] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:46,041 [6564] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201307020022'and ProjectCode =  '201306030001' order by BillNo
2013-10-11 13:56:46,042 [6564] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:46,042 [6564] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2013-10-11 13:56:46,105 [9524] DEBUG Servicemms_receive - 获取动态列表
2013-10-11 13:56:46,106 [9524] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201307020022' order by A.MaterialCode
2013-10-11 13:56:46,166 [9788] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 13:56:46,167 [9788] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('CG00304') order by MerchantsCode
2013-10-11 13:56:46,874 [9536] DEBUG Servicemms_receive - 获取实体对象
2013-10-11 13:56:46,874 [9536] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201307020024'
2013-10-11 13:56:46,875 [9536] DEBUG Servicemms_receive - 获取上一条下一条数据
2013-10-11 13:56:46,875 [9536] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:46,875 [9536] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2013-10-11 13:56:46,876 [9536] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:46,876 [9536] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201307020024'and ProjectCode =  '201306030001' order by BillNo desc
2013-10-11 13:56:46,878 [9536] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:46,878 [9536] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201307020024'and ProjectCode =  '201306030001' order by BillNo
2013-10-11 13:56:46,879 [9536] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:46,879 [9536] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2013-10-11 13:56:46,932 [6564] DEBUG Servicemms_receive - 获取动态列表
2013-10-11 13:56:46,932 [6564] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201307020024' order by A.MaterialCode
2013-10-11 13:56:46,984 [9524] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 13:56:46,985 [9524] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('CG00301') order by MerchantsCode
2013-10-11 13:56:47,794 [9788] DEBUG Servicemms_receive - 获取实体对象
2013-10-11 13:56:47,795 [9788] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201307020032'
2013-10-11 13:56:47,796 [9788] DEBUG Servicemms_receive - 获取上一条下一条数据
2013-10-11 13:56:47,796 [9788] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:47,796 [9788] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2013-10-11 13:56:47,796 [9788] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:47,796 [9788] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201307020032'and ProjectCode =  '201306030001' order by BillNo desc
2013-10-11 13:56:47,798 [9788] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:47,798 [9788] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201307020032'and ProjectCode =  '201306030001' order by BillNo
2013-10-11 13:56:47,800 [9788] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:47,800 [9788] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2013-10-11 13:56:47,841 [9536] DEBUG Servicemms_receive - 获取动态列表
2013-10-11 13:56:47,841 [9536] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201307020032' order by A.MaterialCode
2013-10-11 13:56:47,963 [6564] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 13:56:47,964 [6564] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('CG00301') order by MerchantsCode
2013-10-11 13:56:49,011 [9524] DEBUG Servicemms_receive - 获取实体对象
2013-10-11 13:56:49,011 [9524] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201307020036'
2013-10-11 13:56:49,012 [9524] DEBUG Servicemms_receive - 获取上一条下一条数据
2013-10-11 13:56:49,012 [9524] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:49,012 [9524] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2013-10-11 13:56:49,012 [9524] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:49,013 [9524] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201307020036'and ProjectCode =  '201306030001' order by BillNo desc
2013-10-11 13:56:49,015 [9524] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:49,015 [9524] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201307020036'and ProjectCode =  '201306030001' order by BillNo
2013-10-11 13:56:49,017 [9524] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:49,017 [9524] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2013-10-11 13:56:49,059 [8672] DEBUG Servicemms_receive - 获取动态列表
2013-10-11 13:56:49,060 [8672] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201307020036' order by A.MaterialCode
2013-10-11 13:56:50,170 [10644] DEBUG Servicemms_receive - 获取实体对象
2013-10-11 13:56:50,170 [10644] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '201307030001'
2013-10-11 13:56:50,171 [10644] DEBUG Servicemms_receive - 获取上一条下一条数据
2013-10-11 13:56:50,171 [10644] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:50,171 [10644] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2013-10-11 13:56:50,172 [10644] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:50,172 [10644] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '201307030001'and ProjectCode =  '201306030001' order by BillNo desc
2013-10-11 13:56:50,174 [10644] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:50,174 [10644] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '201307030001'and ProjectCode =  '201306030001' order by BillNo
2013-10-11 13:56:50,176 [10644] DEBUG Servicemms_receive - 获取字段
2013-10-11 13:56:50,176 [10644] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2013-10-11 13:56:50,240 [6564] DEBUG Servicemms_receive - 获取动态列表
2013-10-11 13:56:50,240 [6564] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201307030001' order by A.MaterialCode
2013-10-11 13:56:50,297 [9524] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 13:56:50,298 [9524] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('CG00304') order by MerchantsCode
2013-10-11 13:56:59,756 [10644] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/Index','/Psi/purchase')
2013-10-11 13:57:00,242 [9524] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:57:00,242 [9524] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 13:57:00,243 [9524] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 13:57:05,957 [11456] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 13:57:05,960 [11456] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 13:57:05,960 [11456] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201305110004'
2013-10-11 13:57:05,963 [11456] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 13:57:05,963 [11456] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:57:05,964 [11456] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 13:57:05,964 [11456] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:57:05,964 [11456] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201305110004' order by BillNo desc
2013-10-11 13:57:05,965 [11456] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:57:05,965 [11456] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201305110004' order by BillNo
2013-10-11 13:57:05,965 [11456] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:57:05,965 [11456] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 13:57:06,831 [9536] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 13:57:06,831 [9536] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000002') order by Id
2013-10-11 13:57:07,149 [9524] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:57:07,149 [9524] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201305110004' order by A.RowId
2013-10-11 13:57:08,700 [10644] DEBUG Servicepsi_goods - 获取动态列表
2013-10-11 13:57:08,701 [10644] DEBUG Psi - select top 20 * from psi_goods order by Id
2013-10-11 13:57:08,702 [10644] DEBUG Psi - select count(*) from ( select * from psi_goods ) tb_temp
2013-10-11 13:57:12,065 [9536] DEBUG Servicepsi_purchaseGoods - 获取新主键
2013-10-11 13:57:12,066 [9536] DEBUG Psi - select isnull(max(RowId),0) from psi_purchaseGoods  where 1 = 1 
2013-10-11 13:57:37,387 [7864] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 13:57:37,387 [7864] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201305110005'
2013-10-11 13:57:37,389 [7864] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 13:57:37,389 [7864] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:57:37,389 [7864] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 13:57:37,390 [7864] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:57:37,390 [7864] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201305110005' order by BillNo desc
2013-10-11 13:57:37,392 [7864] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:57:37,392 [7864] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201305110005' order by BillNo
2013-10-11 13:57:37,393 [7864] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:57:37,393 [7864] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 13:57:37,457 [9256] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:57:37,457 [9256] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201305110005' order by A.RowId
2013-10-11 13:57:37,509 [8396] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 13:57:37,509 [8396] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000003') order by Id
2013-10-11 13:57:38,418 [8672] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 13:57:38,418 [8672] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201305110004'
2013-10-11 13:57:38,420 [8672] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 13:57:38,420 [8672] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:57:38,420 [8672] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 13:57:38,421 [8672] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:57:38,421 [8672] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201305110004' order by BillNo desc
2013-10-11 13:57:38,421 [8672] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:57:38,422 [8672] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201305110004' order by BillNo
2013-10-11 13:57:38,422 [8672] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:57:38,422 [8672] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 13:57:38,493 [6564] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:57:38,494 [6564] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201305110004' order by A.RowId
2013-10-11 13:57:38,547 [9536] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 13:57:38,547 [9536] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000002') order by Id
2013-10-11 13:57:41,614 [8396] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2013-10-11 13:57:41,616 [8396] DEBUG Servicemms_warehouse - 获取动态列表
2013-10-11 13:57:41,616 [8396] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2013-10-11 13:57:41,616 [8396] DEBUG Servicesys_code - 获取动态列表
2013-10-11 13:57:41,617 [8396] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2013-10-11 13:57:42,180 [8672] DEBUG Servicemms_receive - 获取动态列表
2013-10-11 13:57:42,180 [8672] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2013-10-11 13:57:42,182 [8672] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2013-10-11 13:57:57,750 [8396] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/Index','/Psi/purchase')
2013-10-11 13:57:58,334 [11944] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:57:58,335 [11944] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 13:57:58,336 [11944] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 13:58:49,123 [6564] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:58:49,123 [6564] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 13:58:49,124 [6564] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 13:59:11,376 [9788] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:59:11,377 [9788] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 13:59:11,378 [9788] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 13:59:17,697 [9788] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:59:17,698 [9788] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 13:59:17,699 [9788] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 13:59:20,032 [7864] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:59:20,032 [7864] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 13:59:20,033 [7864] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 13:59:20,873 [8396] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:59:20,873 [8396] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 13:59:20,874 [8396] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 13:59:21,680 [6564] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:59:21,680 [6564] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 13:59:21,681 [6564] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 13:59:25,716 [9524] DEBUG Servicepsi_purchase - 获取新主键
2013-10-11 13:59:25,717 [9524] DEBUG Psi - select isnull(max(BillNo),0) from psi_purchase
2013-10-11 13:59:25,761 [11944] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 13:59:25,765 [11944] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 13:59:25,765 [11944] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201310110005'
2013-10-11 13:59:25,768 [11944] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 13:59:25,768 [11944] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:59:25,768 [11944] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 13:59:25,769 [11944] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:59:25,769 [11944] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201310110005' order by BillNo desc
2013-10-11 13:59:25,771 [11944] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:59:25,771 [11944] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201310110005' order by BillNo
2013-10-11 13:59:25,772 [11944] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 13:59:25,772 [11944] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 13:59:26,715 [9256] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 13:59:26,716 [9256] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201310110005' order by A.RowId
2013-10-11 13:59:29,243 [9524] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 13:59:29,243 [9524] DEBUG Psi - select top 20 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   order by Id
2013-10-11 13:59:29,243 [9524] DEBUG Psi - select count(*) from ( select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   ) tb_temp
2013-10-11 13:59:30,144 [9256] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 13:59:30,145 [9256] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000003') order by Id
2013-10-11 13:59:37,767 [9524] DEBUG Servicepsi_purchase - 编辑记录
2013-10-11 13:59:37,768 [9524] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 13:59:37,768 [9524] DEBUG Psi - select 
        psi_purchase
    .* from 
        psi_purchase
     where  BillNo =  '201310110005'
2013-10-11 13:59:37,771 [9524] DEBUG Psi - update 
        psi_purchase
     set [BillDate] = '2013-10-11 13:59:25', [DoPerson] = '管理员', [DoDate] = '2013-10-11 13:59:25', [Supplier] = '000003', [ContractName] = '', [PurchaseDate] = '2013-10-11 13:59:25', [PurchasePerson] = '管理员', [TotalMoney] = '0.00', [Remark] = '', [AuditPerson] = '管理员', [AuditDate] = '2013-10-11 13:59:25', [AuditState] = 'Unapproved', [AuditReason] = '', [CreatePerson] = '管理员', [CreateDate] = '2013-10-11 13:59:25', [UpdatePerson] = '管理员', [UpdateDate] = '2013-10-11 13:59:37' where  BillNo =  '201310110005'
2013-10-11 13:59:37,777 [9524] DEBUG Psi - insert into 
        psi_purchase
    ([BillNo],[BillDate],[DoPerson],[DoDate],[Supplier],[ContractName],[PurchaseDate],[PurchasePerson],[TotalMoney],[Remark],[AuditPerson],[AuditDate],[AuditState],[AuditReason],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('201310110005','2013-10-11 13:59:25','管理员','2013-10-11 13:59:25','000003','','2013-10-11 13:59:25','管理员','0.00','','管理员','2013-10-11 13:59:25','Unapproved','','管理员','2013-10-11 13:59:37','管理员','2013-10-11 13:59:37')
2013-10-11 14:01:33,320 [11456] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2013-10-11 14:01:34,234 [9524] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2013-10-11 14:01:34,742 [10464] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 14:01:34,745 [10464] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:01:34,746 [10464] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201310110005'
2013-10-11 14:01:34,747 [10464] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:01:34,748 [10464] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:01:34,748 [10464] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:01:34,748 [10464] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:01:34,748 [10464] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201310110005' order by BillNo desc
2013-10-11 14:01:34,749 [10464] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:01:34,749 [10464] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201310110005' order by BillNo
2013-10-11 14:01:34,749 [10464] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:01:34,749 [10464] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:01:34,792 [9788] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 14:01:34,795 [9788] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:01:34,796 [9788] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201310110005'
2013-10-11 14:01:34,798 [9788] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:01:34,798 [9788] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:01:34,798 [9788] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:01:34,798 [9788] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:01:34,799 [9788] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201310110005' order by BillNo desc
2013-10-11 14:01:34,799 [9788] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:01:34,799 [9788] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201310110005' order by BillNo
2013-10-11 14:01:34,800 [9788] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:01:34,800 [9788] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:01:35,921 [9256] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:01:35,922 [9256] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000003') order by Id
2013-10-11 14:01:36,669 [6564] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:01:36,669 [6564] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000003') order by Id
2013-10-11 14:01:37,022 [8396] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:01:37,022 [8396] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201310110005' order by A.RowId
2013-10-11 14:01:38,750 [7864] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/Index','/Psi/purchase')
2013-10-11 14:01:39,383 [9256] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:01:39,383 [9256] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 14:01:39,384 [9256] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 14:01:42,188 [9788] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 14:01:42,190 [9788] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:01:42,190 [9788] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201305110004'
2013-10-11 14:01:42,192 [9788] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:01:42,193 [9788] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:01:42,193 [9788] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:01:42,193 [9788] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:01:42,193 [9788] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201305110004' order by BillNo desc
2013-10-11 14:01:42,194 [9788] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:01:42,194 [9788] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201305110004' order by BillNo
2013-10-11 14:01:42,194 [9788] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:01:42,194 [9788] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:01:43,043 [7864] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:01:43,043 [7864] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000002') order by Id
2013-10-11 14:01:43,736 [9524] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:01:43,736 [9524] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201305110004' order by A.RowId
2013-10-11 14:01:54,103 [6564] DEBUG Servicepsi_purchase - 删除记录
2013-10-11 14:01:54,107 [6564] DEBUG Psi - delete from psi_purchase where  BillNo =  '201310110003'
2013-10-11 14:01:54,126 [6564] ERROR Servicepsi_purchase - 删除记录失败
System.Exception: 数据已经被引用，更新失败，请先删除引用数据并重试！
   在 Zephyr.Core.Db.<Context>b__2(ErrorEventArgs e) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Core\Db.cs:行号 98
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 105
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.Execute() 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Data\Command\PartialClasses\Execute.cs:行号 9
   在 Zephyr.Data.BaseDeleteBuilder.Execute() 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Data\Builders\Delete\BaseDeleteBuilder.cs:行号 18
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass41.<Delete>b__40() 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseDelete.cs:行号 33
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
2013-10-11 14:01:54,143 [6564] ERROR /api/psi/purchase/201310110003 - System.Exception: 数据已经被引用，更新失败，请先删除引用数据并重试！
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.Delete(ParamDelete param) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Net\Zephyr.Core\Base\ServiceBaseDelete.cs:行号 28
   在 Zephyr.Areas.Psi.Controllers.PurchaseApiController.Delete(String id) 位置 g:\02.进行项目\纵云框架产品\Zephyr.Web-原始版\Zephyr.Web\Areas\Psi\Controllers\PurchaseController.cs:行号 159
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClassf.<GetExecutor>b__9(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
2013-10-11 14:01:59,100 [11456] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 14:01:59,103 [11456] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:01:59,103 [11456] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201310110003'
2013-10-11 14:01:59,106 [11456] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:01:59,107 [11456] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:01:59,107 [11456] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:01:59,107 [11456] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:01:59,107 [11456] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201310110003' order by BillNo desc
2013-10-11 14:01:59,108 [11456] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:01:59,108 [11456] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201310110003' order by BillNo
2013-10-11 14:01:59,108 [11456] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:01:59,108 [11456] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:01:59,838 [7864] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:01:59,839 [7864] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('S1001') order by Id
2013-10-11 14:02:00,156 [9256] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:02:00,156 [9256] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201310110003' order by A.RowId
2013-10-11 14:02:07,826 [7864] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 14:02:07,828 [7864] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:02:07,828 [7864] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201310110003'
2013-10-11 14:02:07,830 [7864] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:02:07,831 [7864] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:02:07,831 [7864] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:02:07,831 [7864] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:02:07,831 [7864] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201310110003' order by BillNo desc
2013-10-11 14:02:07,831 [7864] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:02:07,831 [7864] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201310110003' order by BillNo
2013-10-11 14:02:07,832 [7864] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:02:07,832 [7864] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:02:08,583 [10464] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:02:08,583 [10464] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('S1001') order by Id
2013-10-11 14:02:08,925 [9256] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:02:08,926 [9256] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201310110003' order by A.RowId
2013-10-11 14:02:11,096 [11456] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:02:11,097 [11456] DEBUG Psi - select top 20 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   order by Id
2013-10-11 14:02:11,097 [11456] DEBUG Psi - select count(*) from ( select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   ) tb_temp
2013-10-11 14:02:12,955 [10464] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:02:12,955 [10464] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000004') order by Id
2013-10-11 14:02:14,429 [6564] DEBUG Servicepsi_purchase - 编辑记录
2013-10-11 14:02:14,429 [6564] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:02:14,430 [6564] DEBUG Psi - select 
        psi_purchase
    .* from 
        psi_purchase
     where  BillNo =  '201310110003'
2013-10-11 14:02:14,431 [6564] DEBUG Psi - update 
        psi_purchase
     set [Supplier] = '000004', [UpdatePerson] = '管理员', [UpdateDate] = '2013-10-11 14:02:14' where  BillNo =  '201310110003'
2013-10-11 14:02:16,168 [11244] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:02:16,173 [11244] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 14:02:16,174 [11244] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 14:02:18,666 [9256] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:02:18,666 [9256] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 14:02:18,668 [9256] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 14:02:19,185 [9788] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:02:19,185 [9788] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 14:02:19,186 [9788] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 14:02:24,848 [11456] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 14:02:24,853 [11456] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:02:24,854 [11456] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201305110004'
2013-10-11 14:02:24,856 [11456] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:02:24,856 [11456] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:02:24,856 [11456] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:02:24,857 [11456] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:02:24,857 [11456] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201305110004' order by BillNo desc
2013-10-11 14:02:24,857 [11456] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:02:24,857 [11456] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201305110004' order by BillNo
2013-10-11 14:02:24,857 [11456] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:02:24,858 [11456] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:02:25,563 [6564] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:02:25,563 [6564] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000002') order by Id
2013-10-11 14:02:25,922 [9256] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:02:25,922 [9256] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201305110004' order by A.RowId
2013-10-11 14:04:59,024 [5404] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:04:59,025 [5404] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 14:04:59,026 [5404] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 14:05:00,017 [6564] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 14:05:00,019 [6564] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:05:00,019 [6564] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201305110004'
2013-10-11 14:05:00,021 [6564] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:05:00,021 [6564] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:05:00,021 [6564] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:05:00,022 [6564] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:05:00,022 [6564] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201305110004' order by BillNo desc
2013-10-11 14:05:00,022 [6564] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:05:00,022 [6564] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201305110004' order by BillNo
2013-10-11 14:05:00,022 [6564] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:05:00,023 [6564] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:05:00,955 [7636] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:05:00,955 [7636] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000002') order by Id
2013-10-11 14:05:01,285 [8396] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:05:01,286 [8396] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201305110004' order by A.RowId
2013-10-11 14:06:22,379 [11244] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/Index','/Psi/purchase')
2013-10-11 14:06:23,038 [6564] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:06:23,038 [6564] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 14:06:23,039 [6564] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 14:06:23,841 [9296] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 14:06:23,844 [9296] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:06:23,844 [9296] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201310110003'
2013-10-11 14:06:23,847 [9296] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:06:23,847 [9296] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:06:23,847 [9296] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:06:23,848 [9296] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:06:23,848 [9296] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201310110003' order by BillNo desc
2013-10-11 14:06:23,848 [9296] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:06:23,848 [9296] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201310110003' order by BillNo
2013-10-11 14:06:23,849 [9296] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:06:23,849 [9296] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:06:24,744 [11224] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:06:24,744 [11224] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000004') order by Id
2013-10-11 14:06:25,088 [1840] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:06:25,088 [1840] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201310110003' order by A.RowId
2013-10-11 14:06:30,956 [6564] DEBUG Servicepsi_purchase - 编辑记录
2013-10-11 14:06:30,957 [6564] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:06:30,957 [6564] DEBUG Psi - select 
        psi_purchase
    .* from 
        psi_purchase
     where  BillNo =  '201310110003'
2013-10-11 14:06:30,960 [6564] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:06:30,960 [6564] DEBUG Psi - select 
        psi_purchaseGoods
    .* from 
        psi_purchaseGoods
     where  BillNo =  '201310110003'and RowId =  '1'
2013-10-11 14:06:30,961 [6564] DEBUG Psi - update 
        psi_purchaseGoods
     set [GoodNo] = '1001', [Num] = '1', [UnitPrice] = '0', [Money] = '0', [Remark] = '', [UpdatePerson] = '管理员', [UpdateDate] = '2013-10-11 14:06:30' where  BillNo =  '201310110003'and RowId =  '1'
2013-10-11 14:06:36,299 [1840] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:06:36,304 [1840] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201305110005'
2013-10-11 14:06:36,306 [1840] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:06:36,306 [1840] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:06:36,307 [1840] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:06:36,307 [1840] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:06:36,307 [1840] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201305110005' order by BillNo desc
2013-10-11 14:06:36,307 [1840] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:06:36,308 [1840] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201305110005' order by BillNo
2013-10-11 14:06:36,308 [1840] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:06:36,308 [1840] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:06:36,367 [11108] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:06:36,368 [11108] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201305110005' order by A.RowId
2013-10-11 14:06:36,414 [7840] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:06:36,415 [7840] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000003') order by Id
2013-10-11 14:06:45,986 [9296] DEBUG Servicepsi_purchase - 编辑记录
2013-10-11 14:06:45,986 [9296] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:06:45,987 [9296] DEBUG Psi - select 
        psi_purchase
    .* from 
        psi_purchase
     where  BillNo =  '201305110005'
2013-10-11 14:06:45,990 [9296] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:06:45,990 [9296] DEBUG Psi - select 
        psi_purchaseGoods
    .* from 
        psi_purchaseGoods
     where  BillNo =  '201305110005'and RowId =  '20'
2013-10-11 14:06:45,991 [9296] DEBUG Psi - update 
        psi_purchaseGoods
     set [GoodNo] = '1001', [Num] = '1', [UnitPrice] = '0', [Money] = '0', [Remark] = '', [UpdatePerson] = '管理员', [UpdateDate] = '2013-10-11 14:06:45' where  BillNo =  '201305110005'and RowId =  '20'
2013-10-11 14:06:45,996 [9296] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:06:45,997 [9296] DEBUG Psi - select 
        psi_purchaseGoods
    .* from 
        psi_purchaseGoods
     where  BillNo =  '201305110005'and RowId =  '22'
2013-10-11 14:06:45,998 [9296] DEBUG Psi - update 
        psi_purchaseGoods
     set [GoodNo] = '101003', [Num] = '1', [UnitPrice] = '22', [Money] = '22', [Remark] = '', [UpdatePerson] = '管理员', [UpdateDate] = '2013-10-11 14:06:45' where  BillNo =  '201305110005'and RowId =  '22'
2013-10-11 14:06:46,869 [6564] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:06:46,869 [6564] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201305110004'
2013-10-11 14:06:46,871 [6564] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:06:46,871 [6564] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:06:46,871 [6564] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:06:46,872 [6564] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:06:46,872 [6564] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201305110004' order by BillNo desc
2013-10-11 14:06:46,872 [6564] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:06:46,872 [6564] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201305110004' order by BillNo
2013-10-11 14:06:46,873 [6564] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:06:46,873 [6564] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:06:46,955 [7636] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:06:46,955 [7636] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201305110004' order by A.RowId
2013-10-11 14:06:47,019 [9256] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:06:47,019 [9256] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000002') order by Id
2013-10-11 14:07:14,540 [11244] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:07:14,541 [11244] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201305110001'
2013-10-11 14:07:14,544 [11244] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:07:14,544 [11244] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:14,544 [11244] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:07:14,544 [11244] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:14,544 [11244] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201305110001' order by BillNo desc
2013-10-11 14:07:14,546 [11244] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:14,547 [11244] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201305110001' order by BillNo
2013-10-11 14:07:14,548 [11244] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:14,548 [11244] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:07:14,642 [7636] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:07:14,642 [7636] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201305110001' order by A.RowId
2013-10-11 14:07:24,975 [11244] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:07:24,975 [11244] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201305110002'
2013-10-11 14:07:24,978 [11244] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:07:24,978 [11244] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:24,978 [11244] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:07:24,979 [11244] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:24,979 [11244] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201305110002' order by BillNo desc
2013-10-11 14:07:24,981 [11244] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:24,981 [11244] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201305110002' order by BillNo
2013-10-11 14:07:24,982 [11244] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:24,983 [11244] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:07:25,029 [9256] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:07:25,029 [9256] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201305110002' order by A.RowId
2013-10-11 14:07:25,097 [12208] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:07:25,097 [12208] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000001') order by Id
2013-10-11 14:07:26,192 [11108] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:07:26,192 [11108] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201305110003'
2013-10-11 14:07:26,194 [11108] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:07:26,194 [11108] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:26,194 [11108] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:07:26,194 [11108] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:26,195 [11108] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201305110003' order by BillNo desc
2013-10-11 14:07:26,195 [11108] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:26,195 [11108] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201305110003' order by BillNo
2013-10-11 14:07:26,195 [11108] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:26,196 [11108] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:07:26,428 [11244] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:07:26,428 [11224] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:07:26,428 [11244] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201305110003' order by A.RowId
2013-10-11 14:07:26,428 [11224] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000002') order by Id
2013-10-11 14:07:27,249 [7636] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:07:27,249 [7636] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201305110004'
2013-10-11 14:07:27,251 [7636] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:07:27,251 [7636] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:27,251 [7636] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:07:27,251 [7636] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:27,251 [7636] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201305110004' order by BillNo desc
2013-10-11 14:07:27,252 [7636] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:27,252 [7636] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201305110004' order by BillNo
2013-10-11 14:07:27,252 [7636] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:27,252 [7636] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:07:27,308 [11108] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:07:27,308 [11108] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201305110004' order by A.RowId
2013-10-11 14:07:28,288 [11224] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:07:28,289 [11224] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201305110005'
2013-10-11 14:07:28,290 [11224] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:07:28,290 [11224] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:28,291 [11224] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:07:28,291 [11224] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:28,291 [11224] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201305110005' order by BillNo desc
2013-10-11 14:07:28,291 [11224] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:28,292 [11224] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201305110005' order by BillNo
2013-10-11 14:07:28,292 [11224] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:28,292 [11224] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:07:28,353 [12208] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:07:28,353 [12208] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201305110005' order by A.RowId
2013-10-11 14:07:28,405 [7840] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:07:28,405 [7840] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000003') order by Id
2013-10-11 14:07:29,264 [6564] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:07:29,264 [6564] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201310110003'
2013-10-11 14:07:29,266 [6564] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:07:29,266 [6564] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:29,266 [6564] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:07:29,267 [6564] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:29,267 [6564] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201310110003' order by BillNo desc
2013-10-11 14:07:29,267 [6564] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:29,267 [6564] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201310110003' order by BillNo
2013-10-11 14:07:29,268 [6564] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:29,268 [6564] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:07:29,327 [11224] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:07:29,327 [11224] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201310110003' order by A.RowId
2013-10-11 14:07:29,379 [12208] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:07:29,379 [12208] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000004') order by Id
2013-10-11 14:07:30,215 [11108] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:07:30,216 [11108] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201310110004'
2013-10-11 14:07:30,218 [11108] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:07:30,218 [11108] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:30,218 [11108] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:07:30,219 [11108] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:30,219 [11108] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201310110004' order by BillNo desc
2013-10-11 14:07:30,220 [11108] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:30,220 [11108] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201310110004' order by BillNo
2013-10-11 14:07:30,220 [11108] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:30,220 [11108] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:07:30,285 [6564] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:07:30,285 [6564] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201310110004' order by A.RowId
2013-10-11 14:07:30,333 [11224] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:07:30,333 [11224] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000003') order by Id
2013-10-11 14:07:31,244 [7636] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:07:31,245 [7636] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201310110005'
2013-10-11 14:07:31,246 [7636] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:07:31,246 [7636] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:31,247 [7636] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:07:31,247 [7636] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:31,247 [7636] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201310110005' order by BillNo desc
2013-10-11 14:07:31,247 [7636] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:31,247 [7636] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201310110005' order by BillNo
2013-10-11 14:07:31,248 [7636] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:31,248 [7636] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:07:31,295 [7840] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:07:31,295 [7840] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201310110005' order by A.RowId
2013-10-11 14:07:33,084 [9256] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:07:33,084 [9256] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201310110004'
2013-10-11 14:07:33,087 [9256] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:07:33,087 [9256] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:33,087 [9256] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:07:33,088 [9256] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:33,088 [9256] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201310110004' order by BillNo desc
2013-10-11 14:07:33,088 [9256] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:33,088 [9256] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201310110004' order by BillNo
2013-10-11 14:07:33,089 [9256] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:33,089 [9256] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:07:33,150 [11244] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:07:33,150 [11244] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201310110004' order by A.RowId
2013-10-11 14:07:33,993 [11108] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:07:33,994 [11108] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201310110003'
2013-10-11 14:07:33,996 [11108] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:07:33,996 [11108] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:33,996 [11108] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:07:33,996 [11108] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:33,996 [11108] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201310110003' order by BillNo desc
2013-10-11 14:07:33,997 [11108] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:33,997 [11108] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201310110003' order by BillNo
2013-10-11 14:07:33,997 [11108] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:07:33,997 [11108] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:07:34,043 [7840] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:07:34,043 [7840] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201310110003' order by A.RowId
2013-10-11 14:07:34,093 [11224] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:07:34,094 [11224] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000004') order by Id
2013-10-11 14:21:36,205 [10904] DEBUG Sys - select * from sys_userSetting where UserCode='lhs'
2013-10-11 14:21:37,897 [10904] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'lhs' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'lhs'
  )  
)
order by B.MenuSeq,B.MenuCode
2013-10-11 14:21:45,488 [9732] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Psi/purchase/Index','/Psi/purchase')
2013-10-11 14:21:47,447 [9732] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:21:47,452 [9732] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 14:21:47,453 [9732] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 14:21:47,553 [11604] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Psi/purchase/Index','/Psi/purchase')
2013-10-11 14:21:49,262 [1636] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:21:49,262 [1636] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 14:21:49,263 [1636] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 14:22:03,142 [10904] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 14:22:03,144 [10904] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:22:03,145 [10904] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201305110003'
2013-10-11 14:22:03,146 [10904] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:22:03,147 [10904] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:22:03,147 [10904] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:22:03,147 [10904] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:22:03,147 [10904] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201305110003' order by BillNo desc
2013-10-11 14:22:03,147 [10904] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:22:03,148 [10904] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201305110003' order by BillNo
2013-10-11 14:22:03,148 [10904] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:22:03,148 [10904] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:22:10,405 [11604] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:22:10,406 [11604] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000002') order by Id
2013-10-11 14:22:11,737 [1636] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:22:11,737 [1636] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201305110003' order by A.RowId
2013-10-11 14:22:34,904 [4720] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:22:34,904 [4720] DEBUG Psi - select top 20 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   order by Id
2013-10-11 14:22:34,905 [4720] DEBUG Psi - select count(*) from ( select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   ) tb_temp
2013-10-11 14:23:01,273 [12220] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2013-10-11 14:23:01,275 [12220] DEBUG Servicemms_warehouse - 获取动态列表
2013-10-11 14:23:01,280 [12220] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2013-10-11 14:23:01,280 [12220] DEBUG Servicesys_code - 获取动态列表
2013-10-11 14:23:01,280 [12220] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2013-10-11 14:23:03,378 [11604] DEBUG Servicemms_receive - 获取动态列表
2013-10-11 14:23:03,378 [11604] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2013-10-11 14:23:03,380 [11604] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2013-10-11 14:41:28,816 [7384] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Psi/purchase/Index','/Psi/purchase')
2013-10-11 14:41:30,838 [12204] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:41:30,843 [12204] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 14:41:30,843 [12204] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 14:44:42,850 [9528] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 14:44:42,853 [9528] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:44:42,853 [9528] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201310110003'
2013-10-11 14:44:42,855 [9528] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:44:42,855 [9528] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:44:42,855 [9528] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:44:42,856 [9528] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:44:42,856 [9528] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201310110003' order by BillNo desc
2013-10-11 14:44:42,856 [9528] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:44:42,857 [9528] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201310110003' order by BillNo
2013-10-11 14:44:42,857 [9528] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:44:42,857 [9528] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:44:45,687 [12220] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:44:45,687 [12220] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000004') order by Id
2013-10-11 14:44:47,020 [11224] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:44:47,020 [11224] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201310110003' order by A.RowId
2013-10-11 14:44:51,107 [4720] DEBUG Servicepsi_goods - 获取动态列表
2013-10-11 14:44:51,107 [4720] DEBUG Psi - select top 20 * from psi_goods order by Id
2013-10-11 14:44:51,108 [4720] DEBUG Psi - select count(*) from ( select * from psi_goods ) tb_temp
2013-10-11 14:49:34,401 [9528] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 14:49:34,402 [9528] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201310110004'
2013-10-11 14:49:34,404 [9528] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 14:49:34,404 [9528] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:49:34,404 [9528] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 14:49:34,404 [9528] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:49:34,405 [9528] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201310110004' order by BillNo desc
2013-10-11 14:49:34,405 [9528] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:49:34,405 [9528] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201310110004' order by BillNo
2013-10-11 14:49:34,406 [9528] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 14:49:34,406 [9528] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 14:49:34,673 [10292] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 14:49:34,673 [10292] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201310110004' order by A.RowId
2013-10-11 14:49:34,851 [7384] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 14:49:34,852 [7384] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000003') order by Id
2013-10-11 15:44:51,129 [9936] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 15:44:51,163 [9936] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 15:44:51,170 [9936] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 15:44:51,170 [9936] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 15:44:51,176 [9936] DEBUG Psi - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 15:44:51,177 [9936] DEBUG Psi - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 15:44:53,159 [8832] DEBUG Sys - select * from sys_userSetting where UserCode='lhs'
2013-10-11 15:44:59,912 [5052] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'lhs' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'lhs'
  )  
)
order by B.MenuSeq,B.MenuCode
2013-10-11 15:45:16,914 [10484] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 15:45:16,932 [10484] DEBUG Mms - select top 20 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   order by ProjectCode
2013-10-11 15:45:16,995 [10484] DEBUG Mms - select count(*) from ( select 
    ProjectName as text,ProjectCode as value
   from 
    mms_project
   ) tb_temp
2013-10-11 15:45:50,569 [9668] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Psi/purchase/Index','/Psi/purchase')
2013-10-11 15:45:53,257 [10484] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 15:45:53,258 [10484] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 15:45:53,319 [10484] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 15:46:06,726 [9112] DEBUG Servicepsi_purchase - 获取新主键
2013-10-11 15:46:06,729 [9112] DEBUG Psi - select isnull(max(BillNo),0) from psi_purchase
2013-10-11 15:46:06,842 [5052] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 15:46:06,853 [5052] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 15:46:06,857 [5052] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201310110006'
2013-10-11 15:46:06,908 [5052] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 15:46:06,939 [5052] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 15:46:06,941 [5052] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 15:46:06,942 [5052] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 15:46:06,943 [5052] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201310110006' order by BillNo desc
2013-10-11 15:46:06,946 [5052] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 15:46:06,946 [5052] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201310110006' order by BillNo
2013-10-11 15:46:06,949 [5052] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 15:46:06,949 [5052] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 15:46:11,954 [5052] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 15:46:11,954 [5052] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201310110006' order by A.RowId
2013-10-11 15:47:04,291 [7016] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 15:47:04,322 [7016] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 15:47:04,329 [7016] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 15:47:04,329 [7016] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 15:47:04,335 [7016] DEBUG Psi - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 15:47:04,335 [7016] DEBUG Psi - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2013-10-11 15:47:04,629 [11532] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2013-10-11 15:47:04,653 [11532] DEBUG Servicemms_warehouse - 获取动态列表
2013-10-11 15:47:04,671 [11532] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2013-10-11 15:47:04,672 [11532] DEBUG Servicesys_code - 获取动态列表
2013-10-11 15:47:04,673 [11532] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2013-10-11 15:47:10,203 [11280] DEBUG Servicemms_receive - 获取动态列表
2013-10-11 15:47:10,204 [11280] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2013-10-11 15:47:10,284 [11280] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2013-10-11 15:47:38,694 [11280] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/report/balanceaccount')
2013-10-11 15:47:38,703 [11280] DEBUG Servicemms_warehouse - 获取动态列表
2013-10-11 15:47:38,703 [11280] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2013-10-11 15:47:38,705 [11280] DEBUG Servicemms_buildPart - 获取动态列表
2013-10-11 15:47:38,705 [11280] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where  ProjectCode =  '201306030001'
2013-10-11 15:47:40,075 [8336] DEBUG Mms - 
Select PickUnitName
From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
Where PickUnitName<>'' and PickUnitName<>'其他' and PickUnitName<>'租赁进场'
group by PickUnitName
                
2013-10-11 15:47:40,222 [8336] DEBUG Mms - 
Select MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else 0 end),0) as ReceiveMoney --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Money else 0 end),0) as StockSelfMoney --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Money else 0 end),0) as OwnerSupplyMoney --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Money else 0 end),0) as CallInMoney --调入
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Money else 0 end),0) as ReceiveOtherMoney --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else 0 end),0) as ReceiveNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Num else 0 end),0) as StockSelfNum --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Num else 0 end),0) as OwnerSupplyNum --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Num else 0 end),0) as CallInNum --调入
	,ISNULL(Sum(CASE WHEN SupplyType='租赁进场' then Num else 0 end),0) as ReceiveRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Num else 0 end),0) as ReceiveOtherNum --其他

    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Money else 0 end),0) as SendMoney --合计
    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Num else 0 end),0) as SendNum --合计
     ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Num else 0 end),0) as PickUnitNum0 ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Money else 0 end),0) as PickUnitMoney0 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Num else 0 end),0) as PickUnitNum1 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Money else 0 end),0) as PickUnitMoney1                                                             --领料人生成的列
    ,ISNULL(Sum(CASE WHEN PickUnitName='租赁进场' then Num else 0 end),0) as SendRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Money else 0 end),0) as SendOtherMoney --其他
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Num else 0 end),0) as SendOtherNum --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else -Num end),0) as TotalNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else -Money end),0) as TotalMoney --合计

From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
group by MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit

2013-10-11 15:47:40,464 [8336] DEBUG Mms - 
Select mms_warehouseStockHistory.MaterialCode,sum(Num) As InitNum,sum(UnitPrice*Num) As InitMoney
From mms_warehouseStockHistory
Left join mms_warehouse on mms_warehouse.warehouseCode=mms_warehouseStockHistory.warehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStockHistory.MaterialCode
Where 1=1  And  mms_warehouse.ProjectCode='201306030001'
group by mms_warehouseStockHistory.MaterialCode

2013-10-11 15:47:55,622 [11532] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/report/warehousequery')
2013-10-11 15:47:55,631 [11532] DEBUG Servicemms_warehouse - 获取动态列表
2013-10-11 15:47:55,631 [11532] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2013-10-11 15:47:56,685 [8336] DEBUG Mms - 
Select mms_warehouseStock.*,mms_material.MaterialName,mms_material.Model,mms_warehouse.WarehouseName,
    mms_warehouseStock.WarehouseCode+'_'+mms_material.MaterialCode as id,'' AS name
From mms_warehouseStock
Left join mms_warehouse on mms_warehouseStock.WarehouseCode=mms_warehouse.WarehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStock.MaterialCode
Where mms_warehouse.ProjectCode='201306030001' 

                
2013-10-11 15:48:08,570 [11532] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/report/materialwarnning')
2013-10-11 15:48:09,573 [10036] DEBUG Mms - 
Select mms_materialWarnning.*,mms_material.MaterialName,mms_material.Model,mms_material.Unit
From mms_materialWarnning
Left join mms_material on mms_material.MaterialCode=mms_materialWarnning.MaterialCode
Where mms_materialWarnning.ProjectCode='201306030001' 
                
2013-10-11 15:48:09,637 [11280] DEBUG Mms - 
Select *
From mms_warehouseStock
Left join mms_warehouse on mms_warehouse.WarehouseCode=mms_warehouseStock.WarehouseCode
Where mms_warehouse.ProjectCode='201306030001' and mms_warehouseStock.MaterialCode=''
                
2013-10-11 15:48:11,367 [11280] DEBUG Mms - 
Select *
From mms_warehouseStock
Left join mms_warehouse on mms_warehouse.WarehouseCode=mms_warehouseStock.WarehouseCode
Where mms_warehouse.ProjectCode='201306030001' and mms_warehouseStock.MaterialCode='0101010102'
                
2013-10-11 15:48:15,247 [11280] DEBUG Mms - 
Select *
From mms_warehouseStock
Left join mms_warehouse on mms_warehouse.WarehouseCode=mms_warehouseStock.WarehouseCode
Where mms_warehouse.ProjectCode='201306030001' and mms_warehouseStock.MaterialCode='0101010103'
                
2013-10-11 15:48:35,970 [11532] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Psi/purchase/Index','/Psi/purchase')
2013-10-11 15:48:38,705 [11280] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 15:48:38,705 [11280] DEBUG Psi - select top 20 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' order by A.BillNo
2013-10-11 15:48:38,756 [11280] DEBUG Psi - select count(*) from ( select 
        A.*,B.Name as SupplierName,case when A.AuditState='passed' then 'true' else 'false' end as IsEffect
     from 
        psi_purchase A
        left join psi_supplier  B on B.Id = A.Supplier
     where  isnull(AuditState,'') <> 'passed' ) tb_temp
2013-10-11 15:48:42,395 [12004] DEBUG Servicepsi_purchase - 获取新主键
2013-10-11 15:48:42,398 [12004] DEBUG Psi - select isnull(max(BillNo),0) from psi_purchase
2013-10-11 15:48:42,558 [8336] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Psi/purchase/edit')
2013-10-11 15:48:42,568 [8336] DEBUG Servicepsi_purchase - 获取动态对象
2013-10-11 15:48:42,571 [8336] DEBUG Psi - select *,cast((case when AuditState='passed' then 'true' else 'false' end) as bit) as IsEffect  from psi_purchase where  BillNo =  '201310110006'
2013-10-11 15:48:42,624 [8336] DEBUG Servicepsi_purchase - 获取上一条下一条数据
2013-10-11 15:48:42,651 [8336] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 15:48:42,653 [8336] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo
2013-10-11 15:48:42,655 [8336] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 15:48:42,655 [8336] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo < '201310110006' order by BillNo desc
2013-10-11 15:48:42,657 [8336] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 15:48:42,657 [8336] DEBUG Psi - select top 1 BillNo from psi_purchase where  BillNo >  '201310110006' order by BillNo
2013-10-11 15:48:42,659 [8336] DEBUG Servicepsi_purchase - 获取字段
2013-10-11 15:48:42,659 [8336] DEBUG Psi - select top 1 BillNo from psi_purchase order by BillNo desc
2013-10-11 15:48:47,836 [11532] DEBUG Servicepsi_purchase - 获取动态列表
2013-10-11 15:48:47,836 [11532] DEBUG Psi - select 
        A.*, B.Name,B.Catagory,B.Brand,B.Model,B.Unit
     from 
        psi_purchaseGoods A
        left join psi_goods B on B.Id = A.GoodNo
     where  BillNo =  '201310110006' order by A.RowId
2013-10-11 15:48:54,172 [10724] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 15:48:54,173 [10724] DEBUG Psi - select top 20 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   order by Id
2013-10-11 15:48:54,211 [10724] DEBUG Psi - select count(*) from ( select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   ) tb_temp
2013-10-11 15:48:55,456 [12024] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 15:48:55,457 [12024] DEBUG Psi - select 
    Id   as   value,Name   as   text
   from 
    psi_supplier
   where  Id in ('000002') order by Id
2013-10-11 15:48:57,130 [11280] DEBUG Servicepsi_goods - 获取动态列表
2013-10-11 15:48:57,130 [11280] DEBUG Psi - select top 20 * from psi_goods order by Id
2013-10-11 15:48:57,170 [11280] DEBUG Psi - select count(*) from ( select * from psi_goods ) tb_temp
2013-10-11 15:49:01,817 [10036] DEBUG Servicepsi_purchaseGoods - 获取新主键
2013-10-11 15:49:01,818 [10036] DEBUG Psi - select isnull(max(RowId),0) from psi_purchaseGoods  where 1 = 1 
2013-10-11 15:49:01,819 [10036] DEBUG Psi - select isnull(max(RowId),0) from psi_purchaseGoods  where 1 = 1 
2013-10-11 15:49:01,819 [10036] DEBUG Psi - select isnull(max(RowId),0) from psi_purchaseGoods  where 1 = 1 
2013-10-11 15:49:01,820 [10036] DEBUG Psi - select isnull(max(RowId),0) from psi_purchaseGoods  where 1 = 1 
2013-10-11 15:52:50,693 [11780] DEBUG Servicesys_user - 获取实体对象
2013-10-11 15:52:50,695 [11780] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'lhs'and Password =  'lhs'and IsEnable =  'True'
2013-10-11 15:52:50,719 [11780] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'lhs' 
2013-10-11 15:52:50,795 [11780] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('lhs','刘会胜','LHS-PC','ILData[0]/localhost','','2013-10-11 15:52:50')
2013-10-11 15:52:50,857 [11780] DEBUG Servicemms_project - 获取实体对象
2013-10-11 15:52:50,857 [11780] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2013-10-11 15:52:51,059 [2144] DEBUG Sys - select * from sys_userSetting where UserCode='lhs'
2013-10-11 15:52:54,295 [7824] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'lhs' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'lhs'
  )  
)
order by B.MenuSeq,B.MenuCode
2013-10-11 15:53:56,238 [7668] DEBUG Servicesys_user - 获取实体对象
2013-10-11 15:53:56,239 [7668] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'lhs'and Password =  'lhs'and IsEnable =  'True'
2013-10-11 15:53:56,240 [7668] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'lhs' 
2013-10-11 15:53:56,244 [7668] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('lhs','刘会胜','LHS-PC','localhost','','2013-10-11 15:53:56')
2013-10-11 15:53:56,246 [7668] DEBUG Servicemms_project - 获取实体对象
2013-10-11 15:53:56,246 [7668] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2013-10-11 15:53:56,275 [2144] DEBUG Sys - select * from sys_userSetting where UserCode='lhs'
2013-10-11 15:53:56,622 [7836] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'lhs' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'lhs'
  )  
)
order by B.MenuSeq,B.MenuCode
2013-10-11 15:54:14,759 [12164] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/send/Index','/Mms/send')
2013-10-11 15:54:14,763 [12164] DEBUG Servicemms_warehouse - 获取动态列表
2013-10-11 15:54:14,763 [12164] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2013-10-11 15:54:14,764 [12164] DEBUG Servicesys_code - 获取动态列表
2013-10-11 15:54:14,764 [12164] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2013-10-11 15:54:14,764 [12164] DEBUG Servicesys_code - 获取动态列表
2013-10-11 15:54:14,765 [12164] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2013-10-11 15:54:15,766 [12164] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2013-10-11 15:54:15,767 [12164] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'lhs'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'lhs'
)
2013-10-11 15:54:15,772 [12164] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2013-10-11 15:54:15,773 [12164] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'lhs'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'lhs'
)
order by ButtonSeq
2013-10-11 15:54:17,890 [11064] DEBUG Servicemms_send - 获取动态列表
2013-10-11 15:54:17,891 [11064] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2013-10-11 15:54:17,947 [11064] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2013-10-11 15:54:18,945 [12068] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/send/edit')
2013-10-11 15:54:18,958 [12068] DEBUG Servicemms_send - 获取实体对象
2013-10-11 15:54:18,959 [12068] DEBUG Mms - select mms_send.* from mms_send where  BillNo =  '201307040001'
2013-10-11 15:54:18,966 [12068] DEBUG Servicemms_send - 获取上一条下一条数据
2013-10-11 15:54:18,967 [12068] DEBUG Servicemms_send - 获取字段
2013-10-11 15:54:18,968 [12068] DEBUG Mms - select top 1 BillNo from mms_send where  ProjectCode =  '201306030001' order by BillNo
2013-10-11 15:54:18,971 [12068] DEBUG Servicemms_send - 获取字段
2013-10-11 15:54:18,971 [12068] DEBUG Mms - select top 1 BillNo from mms_send where  BillNo < '201307040001'and ProjectCode =  '201306030001' order by BillNo desc
2013-10-11 15:54:18,974 [12068] DEBUG Servicemms_send - 获取字段
2013-10-11 15:54:18,974 [12068] DEBUG Mms - select top 1 BillNo from mms_send where  BillNo >  '201307040001'and ProjectCode =  '201306030001' order by BillNo
2013-10-11 15:54:18,977 [12068] DEBUG Servicemms_send - 获取字段
2013-10-11 15:54:18,977 [12068] DEBUG Mms - select top 1 BillNo from mms_send where  ProjectCode =  '201306030001' order by BillNo desc
2013-10-11 15:54:19,673 [12068] DEBUG Servicesys_code - 获取动态列表
2013-10-11 15:54:19,674 [12068] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2013-10-11 15:54:19,674 [12068] DEBUG Servicesys_code - 获取动态列表
2013-10-11 15:54:19,674 [12068] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2013-10-11 15:54:19,675 [12068] DEBUG Servicesys_code - 获取动态列表
2013-10-11 15:54:19,676 [12068] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2013-10-11 15:54:19,676 [12068] DEBUG Servicemms_warehouse - 获取动态列表
2013-10-11 15:54:19,677 [12068] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2013-10-11 15:54:19,678 [12068] DEBUG Servicesys_code - 获取字段
2013-10-11 15:54:19,678 [12068] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'Pricing'and IsEnable =  'True'and IsDefault =  'True'
2013-10-11 15:54:20,873 [11064] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 15:54:20,873 [11064] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('FB00504') order by MerchantsCode
2013-10-11 15:54:20,982 [11668] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 15:54:20,982 [11668] DEBUG Mms - select 
    BuildPartCode as value,BuildPartName as text,ParentCode as pid
   from 
    mms_buildPart
   where  BuildPartCode in ('3') order by BuildPartCode
2013-10-11 15:54:21,360 [7824] DEBUG Servicemms_send - 获取动态列表
2013-10-11 15:54:21,360 [7824] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_sendDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201307040001' order by A.MaterialCode
2013-10-11 15:54:33,609 [11064] DEBUG Servicemms_send - 获取实体对象
2013-10-11 15:54:33,610 [11064] DEBUG Mms - select mms_send.* from mms_send where  BillNo =  '201307110001'
2013-10-11 15:54:33,611 [11064] DEBUG Servicemms_send - 获取上一条下一条数据
2013-10-11 15:54:33,611 [11064] DEBUG Servicemms_send - 获取字段
2013-10-11 15:54:33,611 [11064] DEBUG Mms - select top 1 BillNo from mms_send where  ProjectCode =  '201306030001' order by BillNo
2013-10-11 15:54:33,611 [11064] DEBUG Servicemms_send - 获取字段
2013-10-11 15:54:33,611 [11064] DEBUG Mms - select top 1 BillNo from mms_send where  BillNo < '201307110001'and ProjectCode =  '201306030001' order by BillNo desc
2013-10-11 15:54:33,613 [11064] DEBUG Servicemms_send - 获取字段
2013-10-11 15:54:33,613 [11064] DEBUG Mms - select top 1 BillNo from mms_send where  BillNo >  '201307110001'and ProjectCode =  '201306030001' order by BillNo
2013-10-11 15:54:33,615 [11064] DEBUG Servicemms_send - 获取字段
2013-10-11 15:54:33,615 [11064] DEBUG Mms - select top 1 BillNo from mms_send where  ProjectCode =  '201306030001' order by BillNo desc
2013-10-11 15:54:33,680 [12164] DEBUG Servicemms_send - 获取动态列表
2013-10-11 15:54:33,680 [12164] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_sendDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201307110001' order by A.MaterialCode
2013-10-11 15:54:33,781 [12068] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 15:54:33,781 [7824] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 15:54:33,781 [7824] DEBUG Mms - select 
    BuildPartCode as value,BuildPartName as text,ParentCode as pid
   from 
    mms_buildPart
   where  BuildPartCode in ('2') order by BuildPartCode
2013-10-11 15:54:33,797 [12068] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('FB00505') order by MerchantsCode
2013-10-11 15:54:34,780 [2144] DEBUG Servicemms_send - 获取实体对象
2013-10-11 15:54:34,781 [2144] DEBUG Mms - select mms_send.* from mms_send where  BillNo =  '201307230011'
2013-10-11 15:54:34,782 [2144] DEBUG Servicemms_send - 获取上一条下一条数据
2013-10-11 15:54:34,782 [2144] DEBUG Servicemms_send - 获取字段
2013-10-11 15:54:34,782 [2144] DEBUG Mms - select top 1 BillNo from mms_send where  ProjectCode =  '201306030001' order by BillNo
2013-10-11 15:54:34,782 [2144] DEBUG Servicemms_send - 获取字段
2013-10-11 15:54:34,782 [2144] DEBUG Mms - select top 1 BillNo from mms_send where  BillNo < '201307230011'and ProjectCode =  '201306030001' order by BillNo desc
2013-10-11 15:54:34,784 [2144] DEBUG Servicemms_send - 获取字段
2013-10-11 15:54:34,785 [2144] DEBUG Mms - select top 1 BillNo from mms_send where  BillNo >  '201307230011'and ProjectCode =  '201306030001' order by BillNo
2013-10-11 15:54:34,786 [2144] DEBUG Servicemms_send - 获取字段
2013-10-11 15:54:34,786 [2144] DEBUG Mms - select top 1 BillNo from mms_send where  ProjectCode =  '201306030001' order by BillNo desc
2013-10-11 15:54:34,856 [11668] DEBUG Servicemms_send - 获取动态列表
2013-10-11 15:54:34,856 [11668] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_sendDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201307230011' order by A.MaterialCode
2013-10-11 15:54:34,901 [12164] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 15:54:34,901 [12164] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('FB00501') order by MerchantsCode
2013-10-11 15:54:37,676 [12068] DEBUG Servicemms_send - 获取实体对象
2013-10-11 15:54:37,676 [12068] DEBUG Mms - select mms_send.* from mms_send where  BillNo =  '201307110001'
2013-10-11 15:54:37,677 [12068] DEBUG Servicemms_send - 获取上一条下一条数据
2013-10-11 15:54:37,677 [12068] DEBUG Servicemms_send - 获取字段
2013-10-11 15:54:37,677 [12068] DEBUG Mms - select top 1 BillNo from mms_send where  ProjectCode =  '201306030001' order by BillNo
2013-10-11 15:54:37,678 [12068] DEBUG Servicemms_send - 获取字段
2013-10-11 15:54:37,678 [12068] DEBUG Mms - select top 1 BillNo from mms_send where  BillNo < '201307110001'and ProjectCode =  '201306030001' order by BillNo desc
2013-10-11 15:54:37,678 [12068] DEBUG Servicemms_send - 获取字段
2013-10-11 15:54:37,678 [12068] DEBUG Mms - select top 1 BillNo from mms_send where  BillNo >  '201307110001'and ProjectCode =  '201306030001' order by BillNo
2013-10-11 15:54:37,679 [12068] DEBUG Servicemms_send - 获取字段
2013-10-11 15:54:37,679 [12068] DEBUG Mms - select top 1 BillNo from mms_send where  ProjectCode =  '201306030001' order by BillNo desc
2013-10-11 15:54:37,738 [11668] DEBUG Servicemms_send - 获取动态列表
2013-10-11 15:54:37,738 [11668] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_sendDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '201307110001' order by A.MaterialCode
2013-10-11 15:54:37,793 [7668] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 15:54:37,794 [7668] DEBUG Mms - select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  MerchantsCode in ('FB00505') order by MerchantsCode
2013-10-11 15:54:37,811 [12068] DEBUG ServiceModelBase - 获取动态列表
2013-10-11 15:54:37,811 [12068] DEBUG Mms - select 
    BuildPartCode as value,BuildPartName as text,ParentCode as pid
   from 
    mms_buildPart
   where  BuildPartCode in ('2') order by BuildPartCode
